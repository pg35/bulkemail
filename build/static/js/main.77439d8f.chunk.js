(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{43:function(e,t){e.exports="data:image/gif;base64,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"},55:function(e,t,a){e.exports=a(75)},60:function(e,t,a){},75:function(e,t,a){"use strict";a.r(t);var n=a(27),r=a(13),s=a(14),l=a(16),o=a(15),i=a(17),c=a(0),m=a.n(c),u=a(24),A=a.n(u);a(60),a(43);var d=function(e){return Array.isArray(e.v)?e.v.map(function(t,a){return m.a.createElement("span",{key:a},m.a.createElement("strong",null,t),e.v.length-1!==a?", ":"")}):m.a.createElement("strong",null,e.v)};!function(e){function t(t,a,n,r,s){return e.apply(this,arguments)}t.toString=function(){return e.toString()}}(function(e,t,a,n,r){return("GET"===t?fetch(e+n):fetch(e,{method:t,headers:a,body:n})).then(function(e){if(e.status>=200&&e.status<300)return e;!function(e,t){var a=new Error(e);throw a.data=t,a}(e.statusText,e)})});var p=a(26);var E=function(e){return m.a.createElement("div",{className:"mesblkml-quota"},m.a.createElement("table",null,m.a.createElement("tbody",null,m.a.createElement("tr",null,m.a.createElement("th",{colSpan:"2",style:{textAlign:"center"}},"Quota")),m.a.createElement("tr",null,m.a.createElement("th",null,"Limit"),m.a.createElement("td",null,e.limit)),m.a.createElement("tr",null,m.a.createElement("th",null,"Remaining"),m.a.createElement("td",null,e.limit-e.used)),m.a.createElement("tr",null,m.a.createElement("th",null,"Next Renewal"),m.a.createElement("td",null,e.nextRenewal)))))},g=a(22);a(61);function v(e){var t=new URLSearchParams;for(var a in e)t.append(a,e[a]);return t}function h(e,t){var a=new Error(e);throw a.data=t,a}var f=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(o.a)(t).call(this,e))).state={fetching:!1,error:null},a}return Object(i.a)(t,e),Object(s.a)(t,[{key:"fetch",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=this,t=this.props,a=t.baseUrl,n=t.resource,r=t.method,s=t.data,l=t.onSuccess,o=t.onError,i=t.onComplete,c=t.onValidateResponse,m=a+(n?"/"+n:""),u={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:v(s)};this.setState({fetching:!0,error:null}),(r&&"GET"!==r?fetch(m,u):fetch(m+function(e){if(!e)return"";var t=Object.keys(e);return t.length?"?"+t.map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&"):""}(s))).then(function(e){if(e.status>=200&&e.status<300)return e.json();h(e.statusText,e)}).then(function(e){c&&!c(e)&&h(e.msg?e.msg:"Invalid response",e),l&&l(e)}).catch(function(t){e.mounted&&(e.setState({error:t}),o&&o(t))}).finally(function(){e.mounted&&(e.setState({fetching:!1}),i&&i())})})},{key:"componentDidMount",value:function(){this.fetch(),this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e=this;if(this.state.fetching)return m.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},this.props.progressMessage," ..."," ",m.a.createElement("img",{src:"https://i.ibb.co/7V89Rtr/spinner.gif",alt:"loader gif"}));if(this.state.error){var t=this.state.error,a=t.message;return!a&&t.response&&(a=t.response.status+" "+t.response.statusText),m.a.createElement("div",null,m.a.createElement(d,{v:"Failed: ".concat(this.props.progressMessage," ")}),a?"(".concat(a,") "):" ",this.props.canRetry&&m.a.createElement("button",{onClick:function(){e.fetch(),e.props.onRetry()}},"Retry"))}return null}}]),t}(m.a.Component);f.defaultProps={onValidateResponse:function(e){return!e.err},onRetry:function(){},canRetry:!0,baseUrl:window.ajaxurl};var b=f;function w(e){return e[0].replace("\n","<WPPreserveNewline />")}function B(e,t){"undefined"===typeof t&&(t=!0);var a={};if(""===e.trim())return"";if((e+="\n").indexOf("<pre")>-1){var n=e.split("</pre>"),r=n.pop();e="",n.forEach(function(t,n){var r=t.indexOf("<pre");if(-1!==r){var s="<pre wp-pre-tag-"+n+"></pre>";a[s]=t.substr(r)+"</pre>",e+=t.substr(0,r)+s}else e+=t}),e+=r}var s="(?:table|thead|tfoot|caption|col|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|form|map|area|blockquote|address|math|style|p|h[1-6]|hr|fieldset|legend|section|article|aside|hgroup|header|footer|nav|figure|figcaption|details|menu|summary)";(e=(e=(e=(e=e.replace(/<br \/>\s*<br \/>/,"\n\n")).replace(new RegExp("(<"+s+"[^>]*>)","gmi"),"\n$1")).replace(new RegExp("(</"+s+">)","gmi"),"$1\n\n")).replace(/\r\n|\r/,"\n")).indexOf("<option")>-1&&(e=(e=e.replace(/\s*<option'/gim,"<option")).replace(/<\/option>\s*/gim,"</option>")),e.indexOf("</object>")>-1&&(e=(e=(e=e.replace(/(<object[^>]*>)\s*/gim,"$1")).replace(/\s*<\/object>/gim,"</object>")).replace(/\s*(<\/?(?:param|embed)[^>]*>)\s*/gim,"$1")),(e.indexOf("<source")>-1||e.indexOf("<track")>-1)&&(e=(e=(e=e.replace(/([<\[](?:audio|video)[^>\]]*[>\]])\s*/gim,"$1")).replace(/\s*([<\[]\/(?:audio|video)[>\]])/gim,"$1")).replace(/\s*(<(?:source|track)[^>]*>)\s*/gim,"$1"));var l=(e=e.replace(/\n\n+/gim,"\n\n")).split(/\n\s*\n/);return e="",l.forEach(function(t){e+="<p>"+t.replace(/^\s+|\s+$/g,"")+"</p>\n"}),e=(e=(e=(e=(e=(e=(e=(e=e.replace(/<p>\s*<\/p>/gim,"")).replace(/<p>([^<]+)<\/(div|address|form)>/gim,"<p>$1</p></$2>")).replace(new RegExp("<p>s*(</?"+s+"[^>]*>)s*</p>","gmi"),"$1",e)).replace(/<p>(<li.+?)<\/p>/gim,"$1")).replace(/<p><blockquote([^>]*)>/gim,"<blockquote$1><p>")).replace(/<\/blockquote><\/p>/gim,"</p></blockquote>")).replace(new RegExp("<p>s*(</?"+s+"[^>]*>)","gmi"),"$1")).replace(new RegExp("(</?"+s+"[^>]*>)s*</p>","gmi"),"$1"),t&&(e=(e=(e=e.replace(/<(script|style)(?:.|\n)*?<\/\\1>/gim,w)).replace(/(<br \/>)?\s*\n/gim,"<br />\n")).replace("<WPPreserveNewline />","\n")),e=(e=(e=e.replace(new RegExp("(</?"+s+"[^>]*>)s*<br />","gmi"),"$1")).replace(/<br \/>(\s*<\/?(?:p|li|div|dl|dd|dt|th|pre|td|ul|ol)[^>]*>)/gim,"$1")).replace(/\n<\/p>$/gim,"</p>"),Object.keys(a).length&&(e=e.replace(new RegExp(Object.keys(a).join("|"),"gi"),function(e){return a[e]})),e}var C=function(e,t,a){return e>1?t:a};function k(e){return{subject:e.subject,message:B(e.message)}}var Q={subject:'<td id="header_wrapper"><h1>',message:'<div id="body_content_inner">'};function y(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Q;for(var n in a)t=t.replace(a[n],a[n]+e[n]);return t}var S={resumer:{pass:{hasLastEmail:"5d87715c340000c8370a14f7",noLastEmail:"5d87755434000021510a150e"}},quota:{pass:"5d857913320000410f07b267"},app:{hasSavedEmail:"",noSavedEmail:"5d87dc2034000094910a15c6"},delSavedEmail:{pass:""},progress:{pass:""},sender:{pass:""},previewer:{pass:""},error:{code500:"5d87ec3a3300006e00d7d704",custom:"5d8bfa142e00005100abd65f"}},O=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(o.a)(t).call(this,e))).state={deletingSavedEmail:!1},a}return Object(i.a)(t,e),Object(s.a)(t,[{key:"renderSavedEmailInfo",value:function(){var e=this,t=this.props.savedEmail,a=t.postcodes,n=t.sentCount,r=t.customerCount,s=r-n;return m.a.createElement("div",null,m.a.createElement("div",{className:"mes-para"},"Previously, email destined for"," ",C(a.length,"postcodes","postcode")+" ",m.a.createElement("span",null,m.a.createElement(d,{v:a.filter(function(e){return"*"!==e.value}).map(function(e){return e.value})}))," ","was sent to ",m.a.createElement(d,{v:n})," out of"," ",m.a.createElement(d,{v:r})," "+C(r,"customers","customer"),".",m.a.createElement("br",null),"It was saved to be sent to the remaining ",m.a.createElement(d,{v:s})," "+C(r,"customers","customer"),".",m.a.createElement("br",null),"Send it now or delete it."),m.a.createElement("div",{style:{marginTop:"20px"}},this.state.deletingSavedEmail?this.renderDeleteRequest():m.a.createElement("div",{className:"mes-stack"},m.a.createElement(g.a,{to:"/",onClick:function(t){window.confirm("The saved email is still to be sent to ".concat(s," ").concat(C(r,"customers","customer"),".\nAre you sure you want to delete it?"))?e.setState({deletingSavedEmail:!0}):t.preventDefault()}},"Delete Saved Email"),m.a.createElement(g.a,{to:"/preview",style:{marginLeft:"20px"}},"Preview & Send Saved Email"))))}},{key:"renderDeleteRequest",value:function(){var e=this,t=this.props,a=t.nonce,n=t.clientId;return m.a.createElement(b,{data:{action:"mesbulkemailerdelete",nonce:a,clientId:n},method:"POST",resource:S.error.code500&&S.delSavedEmail.pass,progressMessage:"Deleting saved email",onSuccess:function(t){e.setState({deletingSavedEmail:!1}),e.props.onSavedEmailDelete()}})}},{key:"render",value:function(){var e=this.props.savedEmail?this.renderSavedEmailInfo():m.a.createElement(g.a,{to:"/compose"},"Compose Email");return m.a.createElement("div",null,e)}}]),t}(m.a.Component);var I=function(e){return m.a.createElement("div",{id:"mesblkml-home"},m.a.createElement("h2",null,"Home"),m.a.createElement("p",null,"Send email to postcode to have it sent to all Woocommerce customers having the same billing postcode"),m.a.createElement(E,e.quota),m.a.createElement("br",null),m.a.createElement(O,e))};function j(e){var t=e.isValid,a=e.invalidMsg;return m.a.createElement("div",{className:"mes-field ".concat(t?"":"mes-field--error")},m.a.createElement("div",null,e.children),t?null:m.a.createElement("div",{className:"mes-error"},a))}j.defaultProps={invalidMsg:"required"};var D=j,N=a(54),T=a(40),x=a(37),M=a(53),R=a(5),K=function(e){return e.allowSelectAll?m.a.createElement(x.a,Object.assign({},e,{options:[e.allOption].concat(Object(T.a)(e.options)),onChange:function(t,a){if(null!==t&&t.length>0){if(t[t.length-1].value===e.allOption.value)return e.onChange([e.allOption].concat(Object(T.a)(e.options)));var n=[];if(t.length===e.options.length)return t.includes(e.allOption)?n=t.filter(function(t){return t.value!==e.allOption.value}):"select-option"===a.action&&(n=[e.allOption].concat(Object(T.a)(e.options))),e.onChange(n)}return e.onChange(t)}})):m.a.createElement(x.a,e)};K.defaultProps={allOption:{label:"Select all",value:"*"}};var J=function(e){return m.a.createElement("div",null,m.a.createElement(R.z.Option,e,m.a.createElement("input",{type:"checkbox",checked:e.isSelected,onChange:function(){return null}})," ",m.a.createElement("label",null,e.label)))},H="*",P=function(e){var t=e.children,a=Object(N.a)(e,["children"]),n=t;return a.getValue().some(function(e){return e.value===H})&&(n=[[t[0][0]],t[1]]),m.a.createElement(R.z.ValueContainer,a,n)},q=function(e){var t="".concat(e.data.label,", ");return e.data.value===H&&(t="All Postcodes"),m.a.createElement(R.z.MultiValue,e,m.a.createElement("span",null,t))},L=Object(M.a)(),U=K;var F=function(e){var t=e.message,a=e.formattedMessage,n=e.onChange,r=e.onBlur;return m.a.createElement("div",{className:"mesblkml-msgwrap"},m.a.createElement("div",{className:"mesblkml-2cols"},m.a.createElement("div",{className:"mesblkml-msgeditor"},m.a.createElement("div",{className:"mesblkml-title"},"Message Editor"),m.a.createElement("textarea",{value:t,onChange:n,name:"message",placeholder:"Write Message",onKeyDown:function(e){var t=e.target;setTimeout(function(){t.style.cssText="height:auto; padding:0",t.style.cssText="height:"+t.scrollHeight+"px"},0)},onBlur:r})),m.a.createElement("div",{className:"mesblkml-msgpreview"},m.a.createElement("div",{className:"mesblkml-title"},"Message Preview"),m.a.createElement("div",{dangerouslySetInnerHTML:{__html:a}})),m.a.createElement("div",{className:"mesblkml-msgpreview--mobile"},"Message Preview is hidden on Mobile. Please use Email Preview.")),m.a.createElement("div",{className:"mesblkml-msginfo"},m.a.createElement("small",null,m.a.createElement("strong",null,"Info"),m.a.createElement("br",null),"- Use [name] to insert customer billing name in the message e.g. Hi [name], ....",m.a.createElement("br",null),"- Consecutive blank lines will be merged into single blank line in preview and email",m.a.createElement("br",null),'- Do not add line break(s) between "<" and ">" of html tag')))},Y=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).resizeIframe=function(e){var t=e.target,a=t.contentWindow.document.body.scrollHeight;a=Math.max(150,a),t.height=a+"px"},a}return Object(i.a)(t,e),Object(s.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return this.props.count!==e.count}},{key:"render",value:function(){return m.a.createElement("div",{className:"mesblkml-emailpreview"},m.a.createElement("div",{className:"mesblkml-title"},this.props.title),m.a.createElement("iframe",{title:"text",srcDoc:this.props.html,onLoad:this.resizeIframe},m.a.createElement("p",null,"Your browser does not support iframes")))}}]),t}(m.a.Component);var G=function(e){var t=e.postcodes,a=e.subject,n=e.message,r=e.allPostcodes,s=e.readOnly,l=e.onChange,o=e.dirty,i=e.validation,c=e.onPostcodeChange,u=e.touched,A=e.emailTemplate,d=e.onEmailPreviewUpdate,p=e.emailPreviewCount,E=r.map(function(e){return{value:e,label:e}}),g=k({subject:a,message:n}),v=y(g,A);return m.a.createElement("div",{className:"mesblkml-composer"},m.a.createElement(D,{isValid:!o||!u.postcodes||i.postcodes},m.a.createElement("div",{style:{padding:"2px 0"}},m.a.createElement(U,{className:"mes-multiseclct",options:E,isMulti:!0,closeMenuOnSelect:!1,hideSelectedOptions:!1,components:{Option:J,MultiValue:q,ValueContainer:P,animatedComponents:L},onChange:c,allowSelectAll:!0,value:t,placeholder:"Select Postcode(s)"}))),m.a.createElement(D,{isValid:!o||!u.subject||i.subject},m.a.createElement("input",{type:"text",value:a,onChange:l,name:"subject",readOnly:s,placeholder:"Write Subject",onBlur:d})),m.a.createElement(D,{isValid:!o||!u.message||i.message},m.a.createElement(F,{message:n,formattedMessage:g.message,onChange:l,onBlur:d})),m.a.createElement(D,{isValid:!0},m.a.createElement(Y,{html:v,count:p,title:m.a.createElement("span",null,"Email Preview"," ",m.a.createElement("small",null,"(updates when subject or message input loses focus)"))})))};var W=function(e){var t=e.email.dirty?m.a.createElement("div",{className:"mes-hvcenter"},function(){var t=e.email.postcodes.filter(function(e){return"*"!==e.value}).map(function(e){return e.value}).join(",");return m.a.createElement(b,{data:{action:"mesbulkemailerpreview",postcodes:t},resource:S.error.custom&&S.previewer.pass,progressMessage:"Generating preview",onSuccess:function(t){e.onPreviewGenerate(t)}})}()):function(){var t=e.email,a=t.postcodes,n=t.subject,r=t.message,s=e.progress,l=s.sentCount,o=s.customerCount,i=e.quota,c=i.limit,u=i.used,A=e.isNewEmail,p=e.emailPreviewCount,E=e.emailTemplate,g=y(k({subject:n,message:r}),E),v=o-l,h=c-u,f=h?v>h?"There is not enough quota remaining to send ".concat(v," emails. Only ").concat(h," emails can be sent."):"":"Quota has already been consumed";return m.a.createElement("div",null,m.a.createElement("div",{className:"mes-row"},m.a.createElement("div",{className:"mes-row__heading"},C(a.length,"Postcodes","Postcode")),m.a.createElement("div",{className:"mes-row__detail"},m.a.createElement(d,{v:a.filter(function(e){return"*"!==e.value}).map(function(e){return e.value})})," ","(",a.length>1?"all ":"","having"," ",a.length>1?"total ":"",m.a.createElement(d,{v:o})," ",C(o,"customers","customer"),")")),m.a.createElement("div",{className:"mes-row"},m.a.createElement("div",{className:"mes-row__heading"},"Subject"),m.a.createElement("div",{className:"mes-row__detail"},n)),m.a.createElement("div",{className:"mes-row"},m.a.createElement("div",{className:"mes-row__heading"},"Total customers to serve"),m.a.createElement("div",{className:"mes-row__detail"},o," ",m.a.createElement("small",null,"(emails will need to be sent for selected postcodes)"))),!A&&m.a.createElement("div",{className:"mes-row"},m.a.createElement("div",{className:"mes-row__heading"},"Customers already served"),m.a.createElement("div",{className:"mes-row__detail"},l," ",m.a.createElement("small",null,"(emails have already been sent)"))),!A&&m.a.createElement("div",{className:"mes-row"},m.a.createElement("div",{className:"mes-row__heading"},"Customers remaining to be served"),m.a.createElement("div",{className:"mes-row__detail"},v," ",m.a.createElement("small",null,"(emails are remaining to be sent)"))),m.a.createElement("div",{className:"mes-row"},m.a.createElement("div",{className:"mes-row__heading"},"Qutoa"),m.a.createElement("div",{className:"mes-row__detail"},c)),m.a.createElement("div",{className:"mes-row"},m.a.createElement("div",{className:"mes-row__heading"},"Remaining Qutoa"),m.a.createElement("div",{className:"mes-row__detail"},h)),!A&&m.a.createElement(Y,{html:g,count:p,title:"Email"}),m.a.createElement("div",{className:"mes-row",style:{marginTop:"2em"}},m.a.createElement("small",null,m.a.createElement("strong",null,"Processing Info:"),m.a.createElement("br",null),"- Emails will be sent until all emails are sent, qutoa rans out or some unexpected error occurs.",m.a.createElement("br",null),"- If quota is renewed during the processing, it will be consumed.",m.a.createElement("br",null),"- If not all emails are sent, data will be saved to resume the processing later to send remaining emails.",m.a.createElement("br",null))),f&&m.a.createElement("div",{className:"mes-row mes-blkml-preview__feedback"},f))}();return m.a.createElement("div",null,t)},_=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(o.a)(t).call(this,e))).state={fetching:!0},a}return Object(i.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"renderFetchRequest",value:function(){var e=this;return m.a.createElement(b,{data:{action:"mesbulkemailerprogress",clientId:this.props.clientId},resource:S.error.code500&&S.progress.pass,progressMessage:"Fetching progress",onSuccess:function(t){e.mounted&&e.props.onSentCountChange(t.sentCount)},onComplete:function(){e.mounted&&e.setState({fetching:!1}),e.props.stop||setTimeout(function(){return e.mounted&&e.setState({fetching:!0})},e.props.delay||2e3)}})}},{key:"render",value:function(){var e=this.props,t=e.stop,a=e.sentCount,n=e.customerCount;return m.a.createElement("div",{className:"mesblkml-progress"},m.a.createElement("div",{className:"mesblkml-progress__stats"},m.a.createElement("span",null,a)," / ",m.a.createElement("span",null,n)," ",m.a.createElement("span",null,"emails sent")),m.a.createElement("div",{className:"mesblkml-progress__status"},!t&&this.state.fetching?this.renderFetchRequest():m.a.createElement("div",null,"\xa0")))}}]),t}(m.a.Component),Z=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(o.a)(t).call(this,e))).state={sending:!0,fetchProgress:!0,message:"",sentCount:0,customerCount:0},a}return Object(i.a)(t,e),Object(s.a)(t,[{key:"renderSendRequest",value:function(){var e=this,t=this.props,a=t.email,n=a.postcodes,r=a.subject,s=a.message,l=t.progress.clientId,o=t.isNewEmail,i=t.nonce,c=n.filter(function(e){return"*"!==e.value}).map(function(e){return e.value}).join(",");return m.a.createElement(b,{data:{action:"mesbulkemailersend",nonce:i,postcodes:c,subject:r,message:s,clientId:l,isnew:o?"yes":"no"},method:"POST",canRetry:!1,resource:S.error.code500&&S.sender.pass,progressMessage:"Processing",onSuccess:function(t){return e.setState({sending:!1,message:t.msg,sentCount:t.sentCount,customerCount:t.customerCount})},onError:function(t){return e.setState({fetchProgress:!1})},onRetry:function(){return e.setState({fetchProgress:!0})}})}},{key:"render",value:function(){var e=this.state,t=e.sending,a=e.fetchProgress,n=e.message,r=this.props,s=r.progress,l=r.onRestart,o=r.onSentCountChange,i=t?m.a.createElement("div",null,m.a.createElement("div",{className:"mesblkml-sender__status"},this.renderSendRequest()),m.a.createElement(_,Object.assign({},s,{stop:!a,onSentCountChange:o})),!a&&m.a.createElement("div",{className:"mesblkml-retart"},m.a.createElement(g.a,{to:"/",onClick:function(){l()}},"Home"))):m.a.createElement("div",null,m.a.createElement(_,{stop:!0,sentCount:this.state.sentCount,customerCount:this.state.customerCount,onSentCountChange:function(){}}),m.a.createElement("div",{className:"mesblkml-result"},m.a.createElement("div",null,"Completed"),m.a.createElement("div",null,n)),m.a.createElement("div",{className:"mesblkml-retart"},m.a.createElement(g.a,{to:"/",onClick:function(){l()}},"Home")),m.a.createElement("div",null));return m.a.createElement("div",{className:"mesblkml-sender"},i)}}]),t}(m.a.Component);var V=function(e){var t=e.prevPath,a=e.prevLabel,n=e.onPrev,r=e.nextPath,s=e.nextLabel,l=e.onNext,o=function(){};return m.a.createElement("div",{className:"mesblkml-navigation"},t?m.a.createElement(g.a,{to:t,onClick:n||o},a||"Previous"):null,r?m.a.createElement(g.a,{to:r,onClick:l||o},s||"Next"):null)};function X(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function z(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?X(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):X(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var $=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(o.a)(t).call(this,e))).handleSavedEmailDelete=function(){a.setState({isNewEmail:!0,email:a.buildEmailObj(null),progress:a.buildProgressObj(null)})},a.handleEmailDraftChange=function(e){var t,r=e.target,s=r.name,l=r.value;a.setState({email:z({},a.state.email,(t={},Object(n.a)(t,s,l),Object(n.a)(t,"dirty",!0),Object(n.a)(t,"touched",z({},a.state.email.touched,Object(n.a)({},s,1))),t)),progress:z({},a.state.progress,{customerCount:0})})},a.handlePostcodeChange=function(e){a.setState({email:z({},a.state.email,{postcodes:e,dirty:!0,touched:z({},a.state.email.touched,{postcodes:1})}),progress:z({},a.state.progress,{customerCount:0})})},a.handleSentCountChange=function(e){a.setState({progress:z({},a.state.progress,{sentCount:e})})},a.handlerPreviewGenerate=function(e){var t={email:z({},a.state.email,{dirty:!1})};a.state.isNewEmail&&(t.progress=z({},a.state.progress,{customerCount:e.customerCount})),a.setState(t)},a.handleRestart=function(){return a.setState(function(e){return{initCount:e.initCount+1}})},a.handleEmailPreviewUpdate=function(){return a.setState(function(e){return{emailPreviewCount:e.emailPreviewCount+1}})},a.state={initCount:0,isNewEmail:!0,email:{postcodes:null,subject:"",message:"",dirty:!1,touched:{}},progress:{sentCount:0,customerCount:0,clientId:""},quota:{limit:0,used:0,nextRenewal:""},nonce:"",emailTemplate:"",emailPreviewCount:0},a}return Object(i.a)(t,e),Object(s.a)(t,[{key:"buildEmailObj",value:function(e){var t=e&&e.postcodes||null;return t&&(t=t.split(",").map(function(e){return{label:e,value:e}})),{postcodes:t,subject:e&&e.subject||"",message:e&&e.message||"",dirty:!!e,touched:{}}}},{key:"buildProgressObj",value:function(e){return{sentCount:e&&e.sentCount||0,customerCount:e&&e.customerCount||0,clientId:e&&e.clientId||Math.floor(Date.now()/1e3)}}},{key:"renderInitRequest",value:function(){var e=this;return m.a.createElement(b,{data:{action:"mesbulkemailerinit"},resource:S.error.custom&&S.app.hasSavedEmail,progressMessage:this.state.initCount?"Fetching status":"Initializing App",onSuccess:function(t){e.setState(function(a){return{initCount:a.initCount+1,isNewEmail:!t.savedEmail,email:e.buildEmailObj(t.savedEmail),progress:e.buildProgressObj(t.savedEmail),quota:t.quota,nonce:t.nonce,emailTemplate:t.emailTemplate}})},onComplete:function(){return"app oncomplete called"}})}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this,t=this.state,a=t.initCount,r=t.isNewEmail,s=t.email,l=t.progress,o=t.quota,i=t.nonce,c=t.emailTemplate,u=t.emailPreviewCount,A=Object.keys(s).filter(function(e){return"dirty"!==e&&"touched"!==e}).reduce(function(e,t){return z({},e,Object(n.a)({},t,s[t]&&(Array.isArray(s[t])?!!s[t].length:!!String(s[t]).trim())))},{}),E=Object.keys(A).filter(function(e){return!A[e]}).length;return a%2?m.a.createElement(p.a,{initialEntries:["/","/compose","/preview"]},m.a.createElement(p.d,null,m.a.createElement(p.b,{path:"/",exact:!0,render:function(){return m.a.createElement(I,{quota:o,savedEmail:r?null:z({},s,{},l),nonce:i,clientId:l.clientId,onSavedEmailDelete:e.handleSavedEmailDelete})}}),m.a.createElement(p.b,{path:"/compose",exact:!0,render:function(){return m.a.createElement("div",{id:"mesblkml-compose"},m.a.createElement("h2",null,"Compose Email"),m.a.createElement(G,Object.assign({},e.state.email,{allPostcodes:e.props.allPostcodes,onChange:e.handleEmailDraftChange,validation:A,onPostcodeChange:e.handlePostcodeChange,emailTemplate:c,onEmailPreviewUpdate:e.handleEmailPreviewUpdate,emailPreviewCount:u})),m.a.createElement(V,{prevPath:"/",prevLabel:"Home",nextPath:"/preview",nextLabel:"Review",onNext:function(t){var a=e.state.email.dirty;e.setState({email:z({},e.state.email,{dirty:!0,touched:{postcodes:1,subject:1,message:1}})}),E?t.preventDefault():e.setState({email:z({},e.state.email,{dirty:a,touched:{}})})}}))}}),m.a.createElement(p.b,{path:"/preview",exact:!0,render:function(){return m.a.createElement("div",{id:"mesblkml-preview"},m.a.createElement("h2",null,"Preview Email"),m.a.createElement(W,Object.assign({},e.state,{onPreviewGenerate:e.handlerPreviewGenerate})),m.a.createElement(V,{prevPath:r?"/compose":"/",prevLabel:r?"Compose":"Home",nextPath:!!l.customerCount&&"/process",nextLabel:"Confirm & Send",onNext:function(e){window.confirm("Are you sure to send this email?")||e.preventDefault()}}))}}),m.a.createElement(p.b,{path:"/process",exact:!0,render:function(){return m.a.createElement("div",{id:"mesblkml-process"},m.a.createElement("h2",null,"Sending Email"),m.a.createElement("p",null,m.a.createElement("small",null,"having")," subject"," ",m.a.createElement(d,{v:e.state.email.subject})),m.a.createElement("p",null,m.a.createElement("small",null,"to")," ",C(e.state.email.postcodes.length,"postcodes","postcode")," ",m.a.createElement(d,{v:e.state.email.postcodes.filter(function(e){return"*"!==e.value}).map(function(e){return e.value})})),m.a.createElement(Z,Object.assign({},e.state,{onSentCountChange:e.handleSentCountChange,onRestart:e.handleRestart})))}}))):m.a.createElement("div",{className:"mes-hvcenter"},this.renderInitRequest())}}]),t}(m.a.Component);function ee(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function te(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ee(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ee(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var ae=["Test","BT1","BT2","BT3","BT4","BT5","BT6","BT7","BT8","BT9","BT10","BT11","BT12","BT13","BT14","BT15","BT16","BT17","BT18","BT19","BT20","BT21","BT22","BT23","BT24","BT25","BT26","BT27","BT28","BT32","BT36","BT37","BT38","BT61","BT62","BT63","BT64","BT65","BT66","BT67"];m.a.Component;m.a.Component;var ne=document.getElementById("mesblkml");A.a.render(m.a.createElement(function(){return m.a.createElement($,{allPostcodes:ae})},null),ne)}},[[55,1,2]]]);
//# sourceMappingURL=main.77439d8f.chunk.js.map