{"version":3,"sources":["spinner.gif","components/Highlight.js","components/withRequest.js","components/Quota.js","components/JsonRequest.js","wpautop.js","util.js","components/SavedEmailHandler.js","components/HomePage.js","components/Field.js","components/MySelect.js","components/MessageEditorWithPreview.js","components/EmailPreview.js","components/Composer.js","components/Previewer.js","components/Progress.js","components/Sender.js","components/Navigation.js","components/App.js","index.js"],"names":["module","exports","Highlight","props","Array","isArray","v","map","x","i","react_default","a","createElement","key","length","_fetch","fetch","_x","_x2","_x3","_x4","_x5","apply","this","arguments","toString","url","method","headers","payload","config","body","then","response","status","msg","data","error","Error","throwError","statusText","Quota","className","colSpan","style","textAlign","limit","used","nextRenewal","buildPostPayload","URLSearchParams","p","append","JsonRequest","_this","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","state","fetching","_this2","_this$props","baseUrl","resource","onSuccess","onError","onComplete","onValidateResponse","options","Content-Type","setState","params","keys","encodeURIComponent","join","buildQueryString","json","catch","mounted","finally","_this3","display","alignItems","justifyContent","progressMessage","src","alt","detail","message","components_Highlight","concat","canRetry","onClick","onRetry","React","Component","defaultProps","err","window","ajaxurl","_autop_newline_preservation_helper","matches","replace","wpautop","pee","br","pre_tags","trim","indexOf","pee_parts","split","last_pee","pop","forEach","pee_part","index","start","name","substr","allblocks","RegExp","pees","tinkle","matched","plural","c","s","formatEmail","_ref","subject","defaultTokens","insertInStr","str","tokens","undefined","resources","resumer","pass","hasLastEmail","noLastEmail","quota","app","hasSavedEmail","noSavedEmail","delSavedEmail","progress","sender","previewer","code500","custom","SavedEmailHandler","deletingSavedEmail","_this$props$savedEmai","savedEmail","postcodes","sentCount","customerCount","remaining","filter","o","value","marginTop","renderDeleteRequest","react_router_dom","to","e","confirm","preventDefault","marginLeft","nonce","clientId","components_JsonRequest","action","obj","onSavedEmailDelete","element","renderSavedEmailInfo","HomePage","id","components_Quota","components_SavedEmailHandler","Field","isValid","invalidMsg","children","MySelect","allowSelectAll","react_select_browser_esm","assign","allOption","toConsumableArray","onChange","selected","event","result","includes","option","label","Option","chunk_ca26b926_browser_esm","type","checked","isSelected","ValueContainer","objectWithoutProperties","toBeRendered","getValue","some","val","MultiValue","labelToBeDisplayed","animatedComponents","makeAnimated","MessageEditorWithPreview","formattedMessage","onBlur","placeholder","onKeyDown","el","target","setTimeout","cssText","scrollHeight","dangerouslySetInnerHTML","__html","EmailPreview","resizeIframe","iframe","height","contentWindow","document","Math","max","nextProps","nextState","count","title","srcDoc","html","onLoad","Composer","allPostcodes","readOnly","dirty","validation","onPostcodeChange","touched","emailTemplate","onEmailPreviewUpdate","emailPreviewCount","optionsData","postcode","formattedEmail","components_Field","padding","components_MySelect","isMulti","closeMenuOnSelect","hideSelectedOptions","components","components_MessageEditorWithPreview","components_EmailPreview","Previewer","email","onPreviewGenerate","renderGenerateRequest","_props$email","_props$progress","_props$quota","isNewEmail","remainingCustomers","remainingQuota","feedback","renderPreview","Progress","onSentCountChange","stop","delay","renderFetchRequest","Sender","sending","fetchProgress","_this$props$email","strPostcodes","isnew","_this$state","_this$props2","onRestart","renderSendRequest","components_Progress","Navigation","prevPath","prevLabel","onPrev","nextPath","nextLabel","onNext","noop","App","handleSavedEmailDelete","buildEmailObj","buildProgressObj","handleEmailDraftChange","_objectSpread3","_e$target","_objectSpread","defineProperty","handlePostcodeChange","selectedOptionsData","handleSentCountChange","newCount","handlerPreviewGenerate","handleRestart","prevState","initCount","handleEmailPreviewUpdate","floor","Date","now","emailValidation","reduce","String","isInvalidEmail","react_router","initialEntries","path","exact","render","components_HomePage","components_Composer","components_Navigation","components_Previewer","components_Sender","renderInitRequest","rootElement","getElementById","ReactDOM","components_App"],"mappings":"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","file":"static/js/main.77439d8f.chunk.js","sourcesContent":["module.exports = \"data:image/gif;base64,R0lGODlhFAAUAPIHAN3d3Z6enoyMjLGxsfj4+Ovr64CAgP///yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJAwAHACwAAAAAFAAUAEADXHi63C4mykmNYABWKUArWkQoxCQUy7CtxvAFa4BilUzAlHeELLXgvUjAoQAMIALBQEdcGJOWZfOQkQQINw5TARSRKEOFKjhxHcgVBY98oaIlTBB7xih0J7KpvpEAACH5BAkDAAcALAEAAQASABIAAANQeKowIiYMsOopweitQ7EAtA0FkBkCpRTiRjCb8B1n/B4AF+DcSBA1TaMXIxocxiSqpWw6NcynYPDkTKobSrC5u0SNskWombJgkh6LGPmYWBIAIfkECQMABwAsAQABABIAEgAAA1B4qjAiRgyw6inB6K1DsQDEBQ0kUEohbgKhDJrwHRlnBAuw4bqtfYSapuHbrTSOojKybDptjydHIt1MqkNaFXc5KmU5rw+1wCg9lpzDNLEkAAAh+QQJAwAHACwBAAEAEgASAAADUHiqMCJGDLDqKcHorUOxAMRFASRQSiFyAnEQ5ndkozEsQ3cAta7QhkZPM8ltHMPhKslsbpZOiZMzmW4owGYgBe0JZLsuC7XADD2WRUMkISsSACH5BAkDAAcALAEAAQASABIAAANOeKowIkYMsOopweitQ7EAxI0CpRQiCQCZ8B3ZqJkEFByAvJmH2OgdAm7jAGoenJRxyTwqm5ImZyLdwaq3y1PnWoSYvFNM5rF4HRBJ+JAAACH5BAkDAAcALAEAAQASABIAAANOeKowIkYMsOopweitQ7EAxI0CpRTiqD3Rd2SqRhFZcADxuuBGk0cEhsbxMwQAoVVxydykmpLmZiKVvaS2yzMncN22JNMCk/NYdsTHxJIAACH5BAkDAAcALAEAAQASABIAAANQeKowIkYMsOopweitQ7EAxI0CpRTiSH5Hpm7BkAUH8G6DQkDNrZktg8Mn1EFSvpiL6EMyI4MnZyLdUJZM2sX5ErBqXE7Jgrl5LIuGSAJUJAAAIfkECQMABwAsAQABABIAEgAAA094qjAiRgyw6inB6K1DsQDEjQKlFOJIfkemvsEBvFzQaDcdEYrj6IYYIwLUfAiZFDCQUhYjgydnIt1QXE8h6ilgyZwk0wJD81gWDchjYkkAACH5BAkDAAcALAEAAQASABIAAANQeKowIkYMsOopweitQ7EAxI0CpRTiSH5Hpr7BAby00dRdAWQObhCMiO93EuIkBMJAk6o9mMvhZiLdUFzD2KVJE7BkXJVpgaF5LIsG5DGxJAAAIfkECQMABwAsAQABABIAEgAAA054qjAiRgyw6inB6K1DsQDEjQKlFOJIfkemvsEBvLTR1K+DGwFBZKkaQUHQBF/DQzGy62Eig91oIuVQXNLY5fgSsGRcTsnyhH1BusfEkgAAIfkECQMABwAsAQABABIAEgAAA094qjAiJgyw6inB6K1DsQDEjQKlFOJIfkemvsEBvLTR1K+Db+KzDwTCYKcREE7F3VEWGeI8gMyEyKG4iLFLqiZgybaqkgVD81gWDchjYkkAACH5BAkDAAcALAEAAQASABIAAANPeKowIkYMsOopweitQ7EAxI0CpRTiSH5Hpr7BAby00dSvg6spHvS7DyHz8C1mEpyAoBgYJrtAA0Jx7QyxC/AlYMm2I9MCQ/NYjg6IRKxIAAAh+QQJAwAHACwBAAEAEgASAAADT3iqMCJGDLDqKcHorUOxAMSNAqUU4kh+R6a+wQG8tNHUr4Or6e5zA52mpxooCBAJztQyTHDGA9LWrAUhsQvxJWDJtpySBUPzWBYNkYSpSAAAIfkECQMABwAsAQABABIAEgAAA0x4qjAiRgyw6inB6K1DsQDEjQKlFOJIfkemvsEBvLTR1K+Dq+nu1w9cABDSSIAEhmYCXMxsrRqFkIldeiSIgCXDkkwLDM1jcTq0E0sCACH5BAkDAAcALAEAAQASABIAAANNeKowIkYMsOopweitQ7EAxI0CpRTiSH5Hpr7BAby00dSvg6vp7uO9V09SCxBkm0nNdBBRXCoTARK7BDWlm4Alu3JKFgzNY1k0II+JJQEAIfkECQMABwAsAQABABIAEgAAA0x4qjAiRgyw6inB6K1DsQDEjQKlFOJIfkemvsEBvLTR1K+Dq+nu4z2fpDYZcCa0mMJla+UWRoMSxSMcCBABSxaMBLKmBSa5BekiE0sCACH5BAkDAAcALAEAAQASABIAAANQeKowIkYMsOopweitQ7EAxI0CpRTiSH5Hpr7BAby00dSvg6vpvvU+DXAnqQWAE9qH4NJQmpsYI3oCCgiKgZAlAwZuEdMC8xJ4LIsG5DGxJAAAIfkECQMABwAsAQABABIAEgAAA094qjAiRgyw6inB6K1DsQDEjQKlFOJIfkemvsEBvLTR1K+Dq+m+9T4NcCcJbiY5AsG1oTCFBAYndukJorIfS9YbFABM0wJD81gWDchjYkkAACH5BAkDAAcALAEAAQASABIAAANQeKowIkYMsOopweitQ7EAxI0CpRTiSH5Hpr7BAby00dSvg6vpzvW+SHAjGWomqgCB4OJQmhqCgjCKXXrSA5XIkqU8TKJpgaF5LIsG5DGxJAAAIfkECQMABwAsAQABABIAEgAAA094qjAiJgyw6inB6K1DsQDEjQKlFOJIfkemvsEBvLTR1K+Dq8/u+6mfYPDbTEYBAoGoorg0JkIwckpFgwKWTBQAFJiakgVD81gWDchjYkkAACH5BAkDAAcALAEAAQASABIAAANOeKowIkYMsOopweitQ7EAxI0CpRTiSH5Hpr7BAby00dSvg6vp7teP30ZCcuVmmwDhQqMYTS1V7CIaKAi9CEsGkQCMG+gJzPFYFo2g15IAACH5BAkDAAcALAEAAQASABIAAANPeKowIkYMsOopweitQ7EAxI0CpRTiSH5Hpr7BAby00dSvg6vp7uM9n4QzGdQmm5jCpaK4BgujSomKEA6EYIQlgwgC2pIFQ/NYFg2RxLRIAAAh+QQJAwAHACwBAAEAEgASAAADS3iqMCJGDLDqKcHorUOxAMSNAqUU4kh+R6a+wQG8tNHUr4Or6e7XD04QONhQCK7cLLJYvigZAYFBi10gE+eq6TMtMFWWReaASLyKBAAh+QQJAwAHACwBAAEAEgASAAADTniqMCJGDLDqKcHorUOxAMSNAqUU4kh+R6a+wQG8tNHUr4Or6e7johLARZNoTITeaHJcKDmUTIAgq8UukEdNwJI9OSULhuaxLBpZiWmRAAAh+QQJAwAHACwBAAEAEgASAAADTXiqMCJGDLDqKcHorUOxAMSNAqUU4kh+R6a+wQG8tNHUr4Or6Q4PLhxEQFAMhMcYAzeJFA/HGiUTAOKUKJ+AJevxTAsMzWNZNEQSsCIBACH5BAkDAAcALAEAAQASABIAAANQeKowIkYMsOopweitQ7EAxI0CpRTiSH5Hpr7BAby00dSvg6up4OKiAOGyi9gWv5fEMFAQUrmZBJB8Uaq12AVKE7BkXJJpgaF5LIsG5DGxJAAAIfkECQMABwAsAQABABIAEgAAA014qjAiRgyw6inB6K1DsQDEjQKlFOJIfkemvsEBvLTR1K+zpbU4EIQBLqJhEYZE0xEnMQQAmOEEyaG4kLELjyZgybYq0yIK84J0j4klAQAh+QQJAwAHACwBAAEAEgASAAADTHiqMCJGDLDqKcHorUOxAMSNAqUU4kh+R6a+wQG8tNHUr2MEBOHWIoKCgNNAhAdiEcLDLAfF0STKofyKsUsKyJJtVSWLE9YF6R4TSwIAIfkECQMABwAsAQABABIAEgAAA1F4qjAiJgyw6inB6K1DsQDEjQKlFOJIfkemvsEBvLTRRADg1o6tEDXNw8ACBjcDAmFwNIiGRwGziZxRNZTdMXZJ1QQsmVdVsmBoHsuiAXlMLAkAIfkECQMABwAsAQABABIAEgAAA1B4qjAiRgyw6inB6K1DsQDEjQKlFOJIfkemvsEBRJP7ao0xKET6OgZT66YRBQgXokpgIz6UywF0NJlyKE1l7OK7CViyrkp4ym48lkXjKSEfEgAh+QQJAwAHACwBAAEAEgASAAADTHiqMCJGDLDqKcHorUOxAMSNAqUU4kh+RyYNKhccQEQocKw1xszoGocNB4xsXsUkMKWM5JqGCXTXgvpQSgGLxlSVLBidx7JoiCSmRQIAIfkECQMABwAsAQABABIAEgAAA094qjAiRgyw6inB6K1DsQDEjQKlFNAzcsJ3ZAFxAOsWzJp5iHWTKwTeyrEBADI1jTDJbLKWTolzNJlyKMjp7QJdtRYhp+6UHXksYEdqYkkAACH5BAkDAAcALAEAAQASABIAAANOeKowIkYMsOopweitQ7EAxI0CpRRQAISjJnxHJhBM2x2Au+S20WwUQqbn4Dx6LqRy2RIxXYPnZiLVUIbMwMmJfO24TdMC0/NYdsXHxJIAACH5BAkDAAcALAEAAQASABIAAANQeKowIkYMsOopweitQ7EAJAQQF1FKIRIHUXLCd2TGsAxmdwBbsNC5BmeCy2kcxmREyWzmXs5IMVrjUQ0UYNN3gSZjixBTgFpgkh5LGCktKxIAIfkECQMABwAsAQABABIAEgAAA1B4qjAiRgyw6inB6K1DsQBkTBknUEoBSQohbsJ3lAY6c90BcAFx4ZsGTkADOoBIWHL5WgKbTo0kiptQOZSiM5CCImOLkPNkwSQ9lvDxMbEkAAAh+QQFAwAHACwBAAEAEgASAAADUHiqMCJGDLDqKcHorUOxAGQEQDFwAqUUoqESbfQd2fbG4wFwI0GcPBcwSDQ4ikUccqNcappIiZM3mXIotWlgBUXNdF2NaoEpeiyLBuQxsSQAADs=\"","import React from \"react\";\r\n\r\nfunction Highlight(props) {\r\n  const item = Array.isArray(props.v) ? (\r\n    props.v.map((x, i) => (\r\n      <span key={i}>\r\n        <strong>{x}</strong>\r\n        {props.v.length - 1 !== i ? \", \" : \"\"}\r\n      </span>\r\n    ))\r\n  ) : (\r\n    <strong>{props.v}</strong>\r\n  );\r\n  return item;\r\n}\r\n\r\nexport default Highlight;\r\n","import React from \"react\";\r\nimport spinnerPath from \"../spinner.gif\";\r\nimport Highlight from \"./Highlight\";\r\n\r\nexport function buildQueryString(params) {\r\n  if (!params) return \"\";\r\n  const keys = Object.keys(params);\r\n  return keys.length\r\n    ? \"?\" +\r\n        keys\r\n          .map(\r\n            key =>\r\n              encodeURIComponent(key) + \"=\" + encodeURIComponent(params[key])\r\n          )\r\n          .join(\"&\")\r\n    : \"\";\r\n}\r\n\r\nexport function throwError(msg, data) {\r\n  var error = new Error(msg);\r\n  error.data = data;\r\n  throw error;\r\n}\r\n\r\nexport function error2Msg(error) {\r\n  let detail = error.message;\r\n  if (!detail && error.response) {\r\n    detail = error.response.status + \" \" + error.response.statusText;\r\n  }\r\n  return detail;\r\n}\r\n\r\nexport function RequestProgress(props) {\r\n  return (\r\n    <div>\r\n      {props.message} {\"...\"} <img src={spinnerPath} alt=\"loader gif\" />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport function RequestError(props) {\r\n  const { error, showRetry, onRetry } = props;\r\n  return (\r\n    <div>\r\n      <Highlight v={error2Msg(error)} />{\" \"}\r\n      {showRetry && <button onClick={e => onRetry()}>Retry</button>}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport const requestConfig = {\r\n  baseUrl: \"\",\r\n  method: \"GET\",\r\n  defaultHeaders: {\r\n    \"Content-Type\": \"application/json\"\r\n  },\r\n  progressMessage: \"Fetching\",\r\n  getUrl: (props, config) => config.baseUrl,\r\n  getPayload: (props, config) => {},\r\n  getHeaders: (props, config) => config.defaultHeaders,\r\n  formatPayload: (payload, method, config) =>\r\n    \"GET\" === method ? buildQueryString(payload) : JSON.stringify(payload),\r\n  fetch: (url, method, headers, payload, config) => {\r\n    const promise =\r\n      \"GET\" === method\r\n        ? fetch(url + payload)\r\n        : fetch(url, {\r\n            method,\r\n            headers,\r\n            body: payload\r\n          });\r\n    return promise.then(response => {\r\n      if (response.status >= 200 && response.status < 300) {\r\n        return response;\r\n      } else {\r\n        throwError(response.statusText, response);\r\n      }\r\n    });\r\n  },\r\n  onSuccess: (response, props, config) => console.log(\"onSuccess\", response),\r\n  onError: (error, props, config) => console.log(\"error\", error)\r\n};\r\n\r\nconst withRequest = (config = requestConfig) => Component => {\r\n  return class extends React.Component {\r\n    constructor(props) {\r\n      super(props);\r\n      this.state = {\r\n        fetching: false,\r\n        error: null,\r\n        response: null\r\n      };\r\n    }\r\n\r\n    handleRetry = () => this.fetch();\r\n    fetch() {\r\n      const url = config.getUrl(this.props, config);\r\n      const payload = config.formatPayload(\r\n        config.getPayload(this.props, config)\r\n      );\r\n      const headers = config.getHeaders(this.props, config);\r\n      this.setState({ fetching: true, error: null });\r\n      console.info(url, payload, config);\r\n      const promise = config.fetch(\r\n        url,\r\n        config.method,\r\n        headers,\r\n        payload,\r\n        config\r\n      );\r\n      promise\r\n        .then(response => {\r\n          config.onSuccess(response, this.props, config);\r\n          this.setState({ response });\r\n        })\r\n        .catch(error => {\r\n          config.onError(error, this.props);\r\n          this.setState({ error });\r\n        })\r\n        .finally(() => {\r\n          this.setState({ fetching: false });\r\n        });\r\n    }\r\n\r\n    componentDidMount() {\r\n      this.fetch();\r\n    }\r\n\r\n    render() {\r\n      if (this.state.fetching) {\r\n        return <RequestProgress message={config.progressMessage} />;\r\n      }\r\n      if (this.state.error) {\r\n        const { error } = this.state;\r\n        return (\r\n          <RequestError\r\n            error={error}\r\n            onRetry={this.handleRetry}\r\n            showRetry={true}\r\n          />\r\n        );\r\n      }\r\n      return <Component {...this.props} data={this.state.response} />;\r\n    }\r\n  };\r\n};\r\n\r\nexport default withRequest;\r\n","import React from \"react\";\r\n\r\nfunction Quota(props) {\r\n  return (\r\n    <div className=\"mesblkml-quota\">\r\n      <table>\r\n        <tbody>\r\n          <tr>\r\n            <th colSpan=\"2\" style={{ textAlign: \"center\" }}>\r\n              Quota\r\n            </th>\r\n          </tr>\r\n          <tr>\r\n            <th>Limit</th>\r\n            <td>{props.limit}</td>\r\n          </tr>\r\n          <tr>\r\n            <th>Remaining</th>\r\n            <td>{props.limit - props.used}</td>\r\n          </tr>\r\n          <tr>\r\n            <th>Next Renewal</th>\r\n            <td>{props.nextRenewal}</td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Quota;\r\n","import React from \"react\";\r\nimport \"whatwg-fetch\";\r\nimport Highlight from \"./Highlight\";\r\n\r\nfunction buildQueryString(params) {\r\n  if (!params) return \"\";\r\n  const keys = Object.keys(params);\r\n  return keys.length\r\n    ? \"?\" +\r\n        keys\r\n          .map(\r\n            key =>\r\n              encodeURIComponent(key) + \"=\" + encodeURIComponent(params[key])\r\n          )\r\n          .join(\"&\")\r\n    : \"\";\r\n}\r\nfunction buildPostPayload(data) {\r\n  var a = new URLSearchParams();\r\n  for (var p in data) a.append(p, data[p]);\r\n  return a;\r\n}\r\nfunction throwError(msg, data) {\r\n  var error = new Error(msg);\r\n  error.data = data;\r\n  throw error;\r\n}\r\n\r\nclass JsonRequest extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      fetching: false,\r\n      error: null\r\n    };\r\n  }\r\n\r\n  fetch() {\r\n    const {\r\n      baseUrl,\r\n      resource,\r\n      method,\r\n      data,\r\n      onSuccess,\r\n      onError,\r\n      onComplete,\r\n      onValidateResponse\r\n    } = this.props;\r\n    const url = baseUrl + (resource ? \"/\" + resource : \"\");\r\n    const options = {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/x-www-form-urlencoded;charset=UTF-8\"\r\n      },\r\n      body: buildPostPayload(data)\r\n    };\r\n    this.setState({ fetching: true, error: null });\r\n    //console.info(url, resource, method, data, url + buildQueryString(data));\r\n    const promise =\r\n      !method || \"GET\" === method\r\n        ? fetch(url + buildQueryString(data))\r\n        : fetch(url, options);\r\n    promise\r\n      .then(response => {\r\n        //console.log(response);\r\n        if (response.status >= 200 && response.status < 300) {\r\n          return response.json();\r\n        } else {\r\n          throwError(response.statusText, response);\r\n        }\r\n      })\r\n      .then(json => {\r\n        if (onValidateResponse && !onValidateResponse(json)) {\r\n          throwError(json.msg ? json.msg : \"Invalid response\", json);\r\n        }\r\n        onSuccess && onSuccess(json);\r\n      })\r\n      .catch(error => {\r\n        if (this.mounted) {\r\n          this.setState({ error });\r\n          onError && onError(error);\r\n        } //else console.log(\"json request::catching error when unmounted\", error);\r\n      })\r\n      .finally(() => {\r\n        if (this.mounted) {\r\n          this.setState({ fetching: false });\r\n          onComplete && onComplete();\r\n        } //else console.log(\"json request::completed when unmounted\");\r\n      });\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.fetch();\r\n    this.mounted = true;\r\n  }\r\n  componentWillUnmount() {\r\n    this.mounted = false;\r\n  }\r\n  render() {\r\n    if (this.state.fetching) {\r\n      return (\r\n        <div\r\n          style={{\r\n            display: \"flex\",\r\n            alignItems: \"center\",\r\n            justifyContent: \"center\"\r\n          }}\r\n        >\r\n          {this.props.progressMessage} ...{\" \"}\r\n          <img src=\"https://i.ibb.co/7V89Rtr/spinner.gif\" alt=\"loader gif\" />\r\n        </div>\r\n      );\r\n    }\r\n    if (this.state.error) {\r\n      const { error } = this.state;\r\n      //console.log(\"a\", error.message, error.name);\r\n      let detail = error.message;\r\n      if (!detail && error.response) {\r\n        detail = error.response.status + \" \" + error.response.statusText;\r\n      }\r\n      return (\r\n        <div>\r\n          <Highlight v={`Failed: ${this.props.progressMessage} `} />\r\n          {detail ? `(${detail}) ` : \" \"}\r\n          {this.props.canRetry && (\r\n            <button\r\n              onClick={() => {\r\n                this.fetch();\r\n                this.props.onRetry();\r\n              }}\r\n            >\r\n              Retry\r\n            </button>\r\n          )}\r\n        </div>\r\n      );\r\n    }\r\n    return null;\r\n  }\r\n}\r\n//const ajaxurl = \"https://www.alfaoils.co.uk/wp-admin/admin-ajax.php\";\r\nJsonRequest.defaultProps = {\r\n  onValidateResponse: json => !json.err,\r\n  onRetry: () => {},\r\n  canRetry: true,\r\n  baseUrl: window.ajaxurl //\"https://www.mocky.io/v2\"\r\n  //data: { \"mocky-delay\": \"5000ms\" }\r\n};\r\nexport default JsonRequest;\r\n","// source: https://github.com/andymantell/node-wpautop\r\nfunction _autop_newline_preservation_helper(matches) {\r\n  return matches[0].replace(\"\\n\", \"<WPPreserveNewline />\");\r\n}\r\n\r\nexport function wpautop(pee, br) {\r\n  if (typeof br === \"undefined\") {\r\n    br = true;\r\n  }\r\n\r\n  var pre_tags = {};\r\n  if (pee.trim() === \"\") {\r\n    return \"\";\r\n  }\r\n\r\n  pee = pee + \"\\n\"; // just to make things a little easier, pad the end\r\n  if (pee.indexOf(\"<pre\") > -1) {\r\n    var pee_parts = pee.split(\"</pre>\");\r\n    var last_pee = pee_parts.pop();\r\n    pee = \"\";\r\n    pee_parts.forEach(function(pee_part, index) {\r\n      var start = pee_part.indexOf(\"<pre\");\r\n\r\n      // Malformed html?\r\n      if (start === -1) {\r\n        pee += pee_part;\r\n        return;\r\n      }\r\n\r\n      var name = \"<pre wp-pre-tag-\" + index + \"></pre>\";\r\n      pre_tags[name] = pee_part.substr(start) + \"</pre>\";\r\n      pee += pee_part.substr(0, start) + name;\r\n    });\r\n\r\n    pee += last_pee;\r\n  }\r\n\r\n  pee = pee.replace(/<br \\/>\\s*<br \\/>/, \"\\n\\n\");\r\n\r\n  // Space things out a little\r\n  var allblocks =\r\n    \"(?:table|thead|tfoot|caption|col|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|form|map|area|blockquote|address|math|style|p|h[1-6]|hr|fieldset|legend|section|article|aside|hgroup|header|footer|nav|figure|figcaption|details|menu|summary)\";\r\n  pee = pee.replace(new RegExp(\"(<\" + allblocks + \"[^>]*>)\", \"gmi\"), \"\\n$1\");\r\n  pee = pee.replace(new RegExp(\"(</\" + allblocks + \">)\", \"gmi\"), \"$1\\n\\n\");\r\n  pee = pee.replace(/\\r\\n|\\r/, \"\\n\"); // cross-platform newlines\r\n\r\n  if (pee.indexOf(\"<option\") > -1) {\r\n    // no P/BR around option\r\n    pee = pee.replace(/\\s*<option'/gim, \"<option\");\r\n    pee = pee.replace(/<\\/option>\\s*/gim, \"</option>\");\r\n  }\r\n\r\n  if (pee.indexOf(\"</object>\") > -1) {\r\n    // no P/BR around param and embed\r\n    pee = pee.replace(/(<object[^>]*>)\\s*/gim, \"$1\");\r\n    pee = pee.replace(/\\s*<\\/object>/gim, \"</object>\");\r\n    pee = pee.replace(/\\s*(<\\/?(?:param|embed)[^>]*>)\\s*/gim, \"$1\");\r\n  }\r\n\r\n  if (pee.indexOf(\"<source\") > -1 || pee.indexOf(\"<track\") > -1) {\r\n    // no P/BR around source and track\r\n    pee = pee.replace(/([<\\[](?:audio|video)[^>\\]]*[>\\]])\\s*/gim, \"$1\");\r\n    pee = pee.replace(/\\s*([<\\[]\\/(?:audio|video)[>\\]])/gim, \"$1\");\r\n    pee = pee.replace(/\\s*(<(?:source|track)[^>]*>)\\s*/gim, \"$1\");\r\n  }\r\n\r\n  pee = pee.replace(/\\n\\n+/gim, \"\\n\\n\"); // take care of duplicates\r\n\r\n  // make paragraphs, including one at the end\r\n  var pees = pee.split(/\\n\\s*\\n/);\r\n  pee = \"\";\r\n  pees.forEach(function(tinkle) {\r\n    pee += \"<p>\" + tinkle.replace(/^\\s+|\\s+$/g, \"\") + \"</p>\\n\";\r\n  });\r\n\r\n  pee = pee.replace(/<p>\\s*<\\/p>/gim, \"\"); // under certain strange conditions it could create a P of entirely whitespace\r\n  pee = pee.replace(/<p>([^<]+)<\\/(div|address|form)>/gim, \"<p>$1</p></$2>\");\r\n  pee = pee.replace(\r\n    new RegExp(\"<p>s*(</?\" + allblocks + \"[^>]*>)s*</p>\", \"gmi\"),\r\n    \"$1\",\r\n    pee\r\n  ); // don't pee all over a tag\r\n  pee = pee.replace(/<p>(<li.+?)<\\/p>/gim, \"$1\"); // problem with nested lists\r\n  pee = pee.replace(/<p><blockquote([^>]*)>/gim, \"<blockquote$1><p>\");\r\n  pee = pee.replace(/<\\/blockquote><\\/p>/gim, \"</p></blockquote>\");\r\n  pee = pee.replace(\r\n    new RegExp(\"<p>s*(</?\" + allblocks + \"[^>]*>)\", \"gmi\"),\r\n    \"$1\"\r\n  );\r\n  pee = pee.replace(\r\n    new RegExp(\"(</?\" + allblocks + \"[^>]*>)s*</p>\", \"gmi\"),\r\n    \"$1\"\r\n  );\r\n\r\n  if (br) {\r\n    pee = pee.replace(\r\n      /<(script|style)(?:.|\\n)*?<\\/\\\\1>/gim,\r\n      _autop_newline_preservation_helper\r\n    ); // /s modifier from php PCRE regexp replaced with (?:.|\\n)\r\n    pee = pee.replace(/(<br \\/>)?\\s*\\n/gim, \"<br />\\n\"); // optionally make line breaks\r\n    pee = pee.replace(\"<WPPreserveNewline />\", \"\\n\");\r\n  }\r\n\r\n  pee = pee.replace(\r\n    new RegExp(\"(</?\" + allblocks + \"[^>]*>)s*<br />\", \"gmi\"),\r\n    \"$1\"\r\n  );\r\n  pee = pee.replace(\r\n    /<br \\/>(\\s*<\\/?(?:p|li|div|dl|dd|dt|th|pre|td|ul|ol)[^>]*>)/gim,\r\n    \"$1\"\r\n  );\r\n  pee = pee.replace(/\\n<\\/p>$/gim, \"</p>\");\r\n\r\n  if (Object.keys(pre_tags).length) {\r\n    pee = pee.replace(\r\n      new RegExp(Object.keys(pre_tags).join(\"|\"), \"gi\"),\r\n      function(matched) {\r\n        return pre_tags[matched];\r\n      }\r\n    );\r\n  }\r\n\r\n  return pee;\r\n}\r\n","import { wpautop } from \"./wpautop\";\r\n\r\nexport const plural = (c, p, s) => (c > 1 ? p : s);\r\n\r\nexport function formatEmail({ subject, message }) {\r\n  return { subject, message: wpautop(message) };\r\n}\r\nexport const defaultTokens = {\r\n  subject: '<td id=\"header_wrapper\"><h1>',\r\n  message: '<div id=\"body_content_inner\">'\r\n};\r\nexport function insertInStr(data, str, tokens = defaultTokens) {\r\n  for (var p in tokens) {\r\n    str = str.replace(tokens[p], tokens[p] + data[p]);\r\n  }\r\n  return str;\r\n}\r\n//baseurl https://www.mocky.io/v2/\r\nexport const resources = {\r\n  resumer: {\r\n    pass: {\r\n      hasLastEmail: \"5d87715c340000c8370a14f7\",\r\n      noLastEmail: \"5d87755434000021510a150e\"\r\n    }\r\n  },\r\n  quota: {\r\n    pass: \"5d857913320000410f07b267\"\r\n  },\r\n  app: {\r\n    /*{\"err\":0,\"savedEmail\":{\"clientId\":5894,\"postcodes\":[{\"value\":\"BT13\",\"label\":\"BT13\"},{\"value\":\"BT32\",\"label\":\"BT32\"},{\"value\":\"BT17\",\"label\":\"BT17\"}],\"subject\":\"first email\",\"message\":\"first emial body\",\"sentCount\":52,\"customerCount\":100},\"quota\":{\"limit\":100,\"used\":55,\"nextRenewal\":\"in 2 days\"}}*/\r\n    hasSavedEmail: \"\", //\"5d8d155b2e0000fbcfabdec9\",\r\n    noSavedEmail: \"5d87dc2034000094910a15c6\"\r\n  },\r\n  delSavedEmail: {\r\n    pass: \"\" //\"5d87dc2034000094910a15c6\" //same as nosavedemail b/c only {err:0} needed\r\n  },\r\n  progress: {\r\n    pass: \"\" //\"5d88d5113300003008d7dc0c\"\r\n  },\r\n  sender: {\r\n    pass: \"\" //\"5d8aa2493500005c00d46a0d\"\r\n  },\r\n  previewer: {\r\n    pass: \"\" //\"5d8e3f3c3100003e9f2b541e\"\r\n  },\r\n  error: {\r\n    code500: \"5d87ec3a3300006e00d7d704\",\r\n    custom: \"5d8bfa142e00005100abd65f\"\r\n  }\r\n};\r\n","import React from \"react\";\r\n\r\nimport Highlight from \"./Highlight\";\r\nimport { Link } from \"react-router-dom\";\r\nimport JsonRequest from \"./JsonRequest\";\r\nimport { resources, plural } from \"../util\";\r\n\r\nclass SavedEmailHandler extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      deletingSavedEmail: false\r\n    };\r\n  }\r\n\r\n  renderSavedEmailInfo() {\r\n    const { postcodes, sentCount, customerCount } = this.props.savedEmail;\r\n    const remaining = customerCount - sentCount;\r\n    return (\r\n      <div>\r\n        <div className=\"mes-para\">\r\n          Previously, email destined for{\" \"}\r\n          {plural(postcodes.length, \"postcodes\", \"postcode\") + \" \"}\r\n          <span>\r\n            <Highlight\r\n              v={postcodes.filter(o => \"*\" !== o.value).map(o => o.value)}\r\n            />\r\n          </span>{\" \"}\r\n          was sent to <Highlight v={sentCount} /> out of{\" \"}\r\n          <Highlight v={customerCount} />\r\n          {\" \" + plural(customerCount, \"customers\", \"customer\")}.\r\n          <br />\r\n          It was saved to be sent to the remaining <Highlight v={remaining} />\r\n          {\" \" + plural(customerCount, \"customers\", \"customer\")}.\r\n          <br />\r\n          Send it now or delete it.\r\n        </div>\r\n        <div style={{ marginTop: \"20px\" }}>\r\n          {this.state.deletingSavedEmail ? (\r\n            this.renderDeleteRequest()\r\n          ) : (\r\n            <div className=\"mes-stack\">\r\n              <Link\r\n                to=\"/\"\r\n                onClick={e => {\r\n                  if (\r\n                    window.confirm(\r\n                      `The saved email is still to be sent to ${remaining} ${plural(\r\n                        customerCount,\r\n                        \"customers\",\r\n                        \"customer\"\r\n                      )}.\\nAre you sure you want to delete it?`\r\n                    )\r\n                  ) {\r\n                    this.setState({\r\n                      deletingSavedEmail: true\r\n                    });\r\n                  } else {\r\n                    e.preventDefault();\r\n                  }\r\n                }}\r\n              >\r\n                Delete Saved Email\r\n              </Link>\r\n              <Link to=\"/preview\" style={{ marginLeft: \"20px\" }}>\r\n                Preview & Send Saved Email\r\n              </Link>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderDeleteRequest() {\r\n    const { nonce, clientId } = this.props;\r\n    return (\r\n      <JsonRequest\r\n        data={{\r\n          action: \"mesbulkemailerdelete\",\r\n          nonce,\r\n          clientId\r\n        }}\r\n        method=\"POST\"\r\n        resource={resources.error.code500 && resources.delSavedEmail.pass}\r\n        progressMessage=\"Deleting saved email\"\r\n        onSuccess={obj => {\r\n          //console.log(\"delete saved email::\", obj);\r\n          this.setState({\r\n            deletingSavedEmail: false\r\n          });\r\n          this.props.onSavedEmailDelete();\r\n        }}\r\n      />\r\n    );\r\n  }\r\n  render() {\r\n    const element = this.props.savedEmail ? (\r\n      this.renderSavedEmailInfo()\r\n    ) : (\r\n      <Link to=\"/compose\">Compose Email</Link>\r\n    );\r\n    return <div>{element}</div>;\r\n  }\r\n}\r\nexport default SavedEmailHandler;\r\n","import React from \"react\";\r\n\r\nimport Quota from \"./Quota\";\r\nimport SavedEmailHandler from \"./SavedEmailHandler\";\r\n\r\nfunction HomePage(props) {\r\n  //console.log(\"homepage \", props);\r\n  return (\r\n    <div id=\"mesblkml-home\">\r\n      <h2>Home</h2>\r\n      <p>\r\n        Send email to postcode to have it sent to all Woocommerce customers\r\n        having the same billing postcode\r\n      </p>\r\n      <Quota {...props.quota} />\r\n      <br />\r\n      <SavedEmailHandler {...props} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default HomePage;\r\n","import React from \"react\";\r\n\r\nfunction Field(props) {\r\n  const { isValid, invalidMsg } = props;\r\n  return (\r\n    <div className={`mes-field ${isValid ? \"\" : \"mes-field--error\"}`}>\r\n      <div>{props.children}</div>\r\n      {isValid ? null : <div className=\"mes-error\">{invalidMsg}</div>}\r\n    </div>\r\n  );\r\n}\r\n\r\nField.defaultProps = {\r\n  invalidMsg: \"required\"\r\n};\r\nexport default Field;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { default as ReactSelect } from \"react-select\";\r\nimport makeAnimated from \"react-select/animated\";\r\nimport { components } from \"react-select\";\r\n\r\nconst MySelect = props => {\r\n  if (props.allowSelectAll) {\r\n    return (\r\n      <ReactSelect\r\n        {...props}\r\n        options={[props.allOption, ...props.options]}\r\n        onChange={(selected, event) => {\r\n          if (selected !== null && selected.length > 0) {\r\n            if (selected[selected.length - 1].value === props.allOption.value) {\r\n              return props.onChange([props.allOption, ...props.options]);\r\n            }\r\n            let result = [];\r\n            if (selected.length === props.options.length) {\r\n              if (selected.includes(props.allOption)) {\r\n                result = selected.filter(\r\n                  option => option.value !== props.allOption.value\r\n                );\r\n              } else if (event.action === \"select-option\") {\r\n                result = [props.allOption, ...props.options];\r\n              }\r\n              return props.onChange(result);\r\n            }\r\n          }\r\n\r\n          return props.onChange(selected);\r\n        }}\r\n      />\r\n    );\r\n  }\r\n\r\n  return <ReactSelect {...props} />;\r\n};\r\n\r\nMySelect.propTypes = {\r\n  options: PropTypes.array,\r\n  value: PropTypes.any,\r\n  onChange: PropTypes.func,\r\n  allowSelectAll: PropTypes.bool,\r\n  allOption: PropTypes.shape({\r\n    label: PropTypes.string,\r\n    value: PropTypes.string\r\n  })\r\n};\r\n\r\nMySelect.defaultProps = {\r\n  allOption: {\r\n    label: \"Select all\",\r\n    value: \"*\"\r\n  }\r\n};\r\n\r\nexport const Option = props => {\r\n  return (\r\n    <div>\r\n      <components.Option {...props}>\r\n        <input\r\n          type=\"checkbox\"\r\n          checked={props.isSelected}\r\n          onChange={() => null}\r\n        />{\" \"}\r\n        <label>{props.label}</label>\r\n      </components.Option>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst allOption = {\r\n  label: \"Select all\",\r\n  value: \"*\"\r\n};\r\n\r\nexport const ValueContainer = ({ children, ...props }) => {\r\n  const currentValues = props.getValue();\r\n  let toBeRendered = children;\r\n  if (currentValues.some(val => val.value === allOption.value)) {\r\n    toBeRendered = [[children[0][0]], children[1]];\r\n  }\r\n\r\n  return (\r\n    <components.ValueContainer {...props}>\r\n      {toBeRendered}\r\n    </components.ValueContainer>\r\n  );\r\n};\r\n\r\nexport const MultiValue = props => {\r\n  let labelToBeDisplayed = `${props.data.label}, `;\r\n  if (props.data.value === allOption.value) {\r\n    labelToBeDisplayed = \"All Postcodes\";\r\n  }\r\n  return (\r\n    <components.MultiValue {...props}>\r\n      <span>{labelToBeDisplayed}</span>\r\n    </components.MultiValue>\r\n  );\r\n};\r\n\r\nexport const animatedComponents = makeAnimated();\r\n\r\nexport default MySelect;\r\n","import React from \"react\";\r\n\r\nfunction MessageEditorWithPreview(props) {\r\n  const resizeTextArea = e => {\r\n    var el = e.target;\r\n    setTimeout(function() {\r\n      el.style.cssText = \"height:auto; padding:0\";\r\n      // for box-sizing other than \"content-box\" use:\r\n      // el.style.cssText = '-moz-box-sizing:content-box';\r\n      el.style.cssText = \"height:\" + el.scrollHeight + \"px\";\r\n    }, 0);\r\n  };\r\n\r\n  const { message, formattedMessage, onChange, onBlur } = props;\r\n  return (\r\n    <div className=\"mesblkml-msgwrap\">\r\n      <div className=\"mesblkml-2cols\">\r\n        <div className=\"mesblkml-msgeditor\">\r\n          <div className=\"mesblkml-title\">Message Editor</div>\r\n          <textarea\r\n            value={message}\r\n            onChange={onChange}\r\n            name=\"message\"\r\n            placeholder=\"Write Message\"\r\n            onKeyDown={resizeTextArea}\r\n            onBlur={onBlur}\r\n          />\r\n        </div>\r\n        <div className=\"mesblkml-msgpreview\">\r\n          <div className=\"mesblkml-title\">Message Preview</div>\r\n          <div dangerouslySetInnerHTML={{ __html: formattedMessage }} />\r\n        </div>\r\n        <div className=\"mesblkml-msgpreview--mobile\">\r\n          Message Preview is hidden on Mobile. Please use Email Preview.\r\n        </div>\r\n      </div>\r\n      <div className=\"mesblkml-msginfo\">\r\n        <small>\r\n          <strong>Info</strong>\r\n          <br />\r\n          - Use [name] to insert customer billing name in the message e.g. Hi\r\n          [name], ....\r\n          <br />\r\n          - Consecutive blank lines will be merged into single blank line in\r\n          preview and email\r\n          <br />- Do not add line break(s) between \"&lt;\" and \"&gt;\" of html tag\r\n        </small>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\nexport default MessageEditorWithPreview;\r\n","import React from \"react\";\r\n\r\nclass EmailPreview extends React.Component {\r\n  shouldComponentUpdate(nextProps, nextState) {\r\n    return this.props.count !== nextProps.count;\r\n  }\r\n\r\n  resizeIframe = e => {\r\n    const iframe = e.target;\r\n    let height = iframe.contentWindow.document.body.scrollHeight;\r\n    height = Math.max(150, height);\r\n    iframe.height = height + \"px\";\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"mesblkml-emailpreview\">\r\n        <div className=\"mesblkml-title\">{this.props.title}</div>\r\n        <iframe\r\n          title=\"text\"\r\n          srcDoc={this.props.html}\r\n          onLoad={this.resizeIframe}\r\n        >\r\n          <p>Your browser does not support iframes</p>\r\n        </iframe>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default EmailPreview;\r\n","import React from \"react\";\r\nimport Field from \"./Field\";\r\nimport MySelect, {\r\n  Option,\r\n  MultiValue,\r\n  ValueContainer,\r\n  animatedComponents\r\n} from \"./MySelect.js\";\r\nimport MessageEditorWithPreview from \"./MessageEditorWithPreview\";\r\nimport EmailPreview from \"./EmailPreview\";\r\n\r\nimport { formatEmail, insertInStr } from \"../util\";\r\n\r\nfunction Composer(props) {\r\n  const {\r\n    postcodes,\r\n    subject,\r\n    message,\r\n    allPostcodes,\r\n    readOnly,\r\n    onChange,\r\n    dirty,\r\n    validation,\r\n    onPostcodeChange,\r\n    touched,\r\n    emailTemplate,\r\n    onEmailPreviewUpdate,\r\n    emailPreviewCount\r\n  } = props;\r\n\r\n  const optionsData = allPostcodes.map(postcode => ({\r\n    value: postcode,\r\n    label: postcode\r\n  }));\r\n\r\n  const formattedEmail = formatEmail({ subject, message });\r\n  const html = insertInStr(formattedEmail, emailTemplate);\r\n\r\n  return (\r\n    <div className=\"mesblkml-composer\">\r\n      <Field isValid={dirty && touched.postcodes ? validation.postcodes : true}>\r\n        <div style={{ padding: \"2px 0\" }}>\r\n          <MySelect\r\n            className=\"mes-multiseclct\"\r\n            options={optionsData}\r\n            isMulti\r\n            closeMenuOnSelect={false}\r\n            hideSelectedOptions={false}\r\n            components={{\r\n              Option,\r\n              MultiValue,\r\n              ValueContainer,\r\n              animatedComponents\r\n            }}\r\n            onChange={onPostcodeChange}\r\n            allowSelectAll={true}\r\n            value={postcodes}\r\n            placeholder=\"Select Postcode(s)\"\r\n          />\r\n        </div>\r\n      </Field>\r\n      <Field isValid={dirty && touched.subject ? validation.subject : true}>\r\n        <input\r\n          type=\"text\"\r\n          value={subject}\r\n          onChange={onChange}\r\n          name=\"subject\"\r\n          readOnly={readOnly}\r\n          placeholder=\"Write Subject\"\r\n          onBlur={onEmailPreviewUpdate}\r\n        />\r\n      </Field>\r\n      <Field isValid={dirty && touched.message ? validation.message : true}>\r\n        <MessageEditorWithPreview\r\n          message={message}\r\n          formattedMessage={formattedEmail.message}\r\n          onChange={onChange}\r\n          onBlur={onEmailPreviewUpdate}\r\n        />\r\n      </Field>\r\n      <Field isValid={true}>\r\n        <EmailPreview\r\n          html={html}\r\n          count={emailPreviewCount}\r\n          title={\r\n            <span>\r\n              Email Preview{\" \"}\r\n              <small>(updates when subject or message input loses focus)</small>\r\n            </span>\r\n          }\r\n        />\r\n      </Field>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Composer;\r\n","import React from \"react\";\r\n\r\nimport Highlight from \"./Highlight\";\r\nimport JsonRequest from \"./JsonRequest\";\r\nimport EmailPreview from \"./EmailPreview\";\r\nimport { resources, plural, formatEmail, insertInStr } from \"../util\";\r\n\r\nfunction Previewer(props) {\r\n  const renderPreview = () => {\r\n    const {\r\n      email: { postcodes, subject, message },\r\n      progress: { sentCount, customerCount },\r\n      quota: { limit, used },\r\n      isNewEmail,\r\n      emailPreviewCount,\r\n      emailTemplate\r\n    } = props;\r\n\r\n    const formattedEmail = formatEmail({ subject, message });\r\n    const html = insertInStr(formattedEmail, emailTemplate);\r\n\r\n    const remainingCustomers = customerCount - sentCount;\r\n    const remainingQuota = limit - used;\r\n    const feedback = !remainingQuota\r\n      ? \"Quota has already been consumed\"\r\n      : remainingCustomers > remainingQuota\r\n      ? `There is not enough quota remaining to send ${remainingCustomers} emails. Only ${remainingQuota} emails can be sent.`\r\n      : \"\";\r\n    return (\r\n      <div>\r\n        <div className=\"mes-row\">\r\n          <div className=\"mes-row__heading\">\r\n            {plural(postcodes.length, \"Postcodes\", \"Postcode\")}\r\n          </div>\r\n          <div className=\"mes-row__detail\">\r\n            <Highlight\r\n              v={postcodes.filter(o => \"*\" !== o.value).map(o => o.value)}\r\n            />{\" \"}\r\n            ({postcodes.length > 1 ? \"all \" : \"\"}having{\" \"}\r\n            {postcodes.length > 1 ? \"total \" : \"\"}\r\n            <Highlight v={customerCount} />{\" \"}\r\n            {plural(customerCount, \"customers\", \"customer\")})\r\n          </div>\r\n        </div>\r\n        <div className=\"mes-row\">\r\n          <div className=\"mes-row__heading\">Subject</div>\r\n          <div className=\"mes-row__detail\">{subject}</div>\r\n        </div>\r\n        {/*<div className=\"mes-row\">\r\n          <div className=\"mes-row__heading\">Message</div>\r\n          <div\r\n            className=\"mes-row__detail\"\r\n            style={{ border: \"1px dotted #000\" }}\r\n            dangerouslySetInnerHTML={{\r\n              __html: (() => message.replace(/(?:\\r\\n|\\r|\\n)/g, \"<br/>\"))()\r\n            }}\r\n          />\r\n        </div>\r\n          */}\r\n        <div className=\"mes-row\">\r\n          <div className=\"mes-row__heading\">Total customers to serve</div>\r\n          <div className=\"mes-row__detail\">\r\n            {customerCount}{\" \"}\r\n            <small>(emails will need to be sent for selected postcodes)</small>\r\n          </div>\r\n        </div>\r\n        {!isNewEmail && (\r\n          <div className=\"mes-row\">\r\n            <div className=\"mes-row__heading\">Customers already served</div>\r\n            <div className=\"mes-row__detail\">\r\n              {sentCount} <small>(emails have already been sent)</small>\r\n            </div>\r\n          </div>\r\n        )}\r\n        {!isNewEmail && (\r\n          <div className=\"mes-row\">\r\n            <div className=\"mes-row__heading\">\r\n              Customers remaining to be served\r\n            </div>\r\n            <div className=\"mes-row__detail\">\r\n              {remainingCustomers}{\" \"}\r\n              <small>(emails are remaining to be sent)</small>\r\n            </div>\r\n          </div>\r\n        )}\r\n        <div className=\"mes-row\">\r\n          <div className=\"mes-row__heading\">Qutoa</div>\r\n          <div className=\"mes-row__detail\">{limit}</div>\r\n        </div>\r\n        <div className=\"mes-row\">\r\n          <div className=\"mes-row__heading\">Remaining Qutoa</div>\r\n          <div className=\"mes-row__detail\">{remainingQuota}</div>\r\n        </div>\r\n        {!isNewEmail && (\r\n          <EmailPreview html={html} count={emailPreviewCount} title=\"Email\" />\r\n        )}\r\n        <div className=\"mes-row\" style={{ marginTop: \"2em\" }}>\r\n          <small>\r\n            <strong>Processing Info:</strong>\r\n            <br />\r\n            - Emails will be sent until all emails are sent, qutoa rans out or\r\n            some unexpected error occurs.\r\n            <br />\r\n            - If quota is renewed during the processing, it will be consumed.\r\n            <br />\r\n            - If not all emails are sent, data will be saved to resume the\r\n            processing later to send remaining emails.\r\n            <br />\r\n          </small>\r\n        </div>\r\n        {feedback && (\r\n          <div className=\"mes-row mes-blkml-preview__feedback\">{feedback}</div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderGenerateRequest = () => {\r\n    const postcodes = props.email.postcodes\r\n      .filter(o => \"*\" !== o.value)\r\n      .map(o => o.value)\r\n      .join(\",\");\r\n    return (\r\n      <JsonRequest\r\n        data={{ action: \"mesbulkemailerpreview\", postcodes }}\r\n        resource={resources.error.custom && resources.previewer.pass}\r\n        progressMessage=\"Generating preview\"\r\n        onSuccess={obj => {\r\n          //console.log(\"preview::\", obj);\r\n          props.onPreviewGenerate(obj);\r\n        }}\r\n      />\r\n    );\r\n  };\r\n\r\n  const element = props.email.dirty ? (\r\n    <div className=\"mes-hvcenter\">{renderGenerateRequest()}</div>\r\n  ) : (\r\n    renderPreview()\r\n  );\r\n  return <div>{element}</div>;\r\n}\r\nexport default Previewer;\r\n","import React from \"react\";\r\n\r\nimport JsonRequest from \"./JsonRequest\";\r\nimport { resources } from \"../util\";\r\n\r\nclass Progress extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      fetching: true\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.mounted = true;\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.mounted = false;\r\n  }\r\n\r\n  renderFetchRequest() {\r\n    return (\r\n      <JsonRequest\r\n        data={{\r\n          action: \"mesbulkemailerprogress\",\r\n          clientId: this.props.clientId\r\n        }}\r\n        resource={resources.error.code500 && resources.progress.pass}\r\n        progressMessage=\"Fetching progress\"\r\n        onSuccess={obj => {\r\n          //console.log(this.props);\r\n          this.mounted && this.props.onSentCountChange(obj.sentCount);\r\n        }}\r\n        onComplete={() => {\r\n          this.mounted && this.setState({ fetching: false });\r\n          if (!this.props.stop) {\r\n            setTimeout(\r\n              () => this.mounted && this.setState({ fetching: true }),\r\n              this.props.delay || 2000\r\n            );\r\n          }\r\n        }}\r\n      />\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const { stop, sentCount, customerCount } = this.props;\r\n    return (\r\n      <div className=\"mesblkml-progress\">\r\n        <div className=\"mesblkml-progress__stats\">\r\n          <span>{sentCount}</span> / <span>{customerCount}</span>{\" \"}\r\n          <span>emails sent</span>\r\n        </div>\r\n        <div className=\"mesblkml-progress__status\">\r\n          {!stop && this.state.fetching ? (\r\n            this.renderFetchRequest()\r\n          ) : (\r\n            <div>&nbsp;</div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default Progress;\r\n","import React from \"react\";\r\n\r\nimport { Link } from \"react-router-dom\";\r\nimport JsonRequest from \"./JsonRequest\";\r\nimport Progress from \"./Progress\";\r\n\r\nimport { resources } from \"../util\";\r\n\r\nclass Sender extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      sending: true,\r\n      fetchProgress: true,\r\n      message: \"\",\r\n      sentCount: 0,\r\n      customerCount: 0\r\n    };\r\n  }\r\n\r\n  renderSendRequest() {\r\n    const {\r\n      email: { postcodes, subject, message },\r\n      progress: { clientId },\r\n      isNewEmail,\r\n      nonce\r\n    } = this.props;\r\n    const strPostcodes = postcodes\r\n      .filter(o => \"*\" !== o.value)\r\n      .map(o => o.value)\r\n      .join(\",\");\r\n    return (\r\n      <JsonRequest\r\n        data={{\r\n          action: \"mesbulkemailersend\",\r\n          nonce,\r\n          postcodes: strPostcodes,\r\n          subject,\r\n          message,\r\n          clientId,\r\n          isnew: isNewEmail ? \"yes\" : \"no\"\r\n        }}\r\n        method=\"POST\"\r\n        canRetry={false}\r\n        resource={resources.error.code500 && resources.sender.pass}\r\n        progressMessage=\"Processing\"\r\n        onSuccess={obj =>\r\n          this.setState({\r\n            sending: false,\r\n            message: obj.msg,\r\n            sentCount: obj.sentCount,\r\n            customerCount: obj.customerCount\r\n          })\r\n        }\r\n        onError={err => this.setState({ fetchProgress: false })}\r\n        onRetry={() => this.setState({ fetchProgress: true })}\r\n      />\r\n    );\r\n  }\r\n  render() {\r\n    const { sending, fetchProgress, message } = this.state;\r\n    const { progress, onRestart, onSentCountChange } = this.props;\r\n    const element = sending ? (\r\n      <div>\r\n        <div className=\"mesblkml-sender__status\">\r\n          {this.renderSendRequest()}\r\n        </div>\r\n        <Progress\r\n          {...progress}\r\n          stop={!fetchProgress}\r\n          onSentCountChange={onSentCountChange}\r\n        />\r\n        {!fetchProgress && (\r\n          <div className=\"mesblkml-retart\">\r\n            <Link\r\n              to=\"/\"\r\n              onClick={() => {\r\n                onRestart();\r\n              }}\r\n            >\r\n              Home\r\n            </Link>\r\n          </div>\r\n        )}\r\n      </div>\r\n    ) : (\r\n      <div>\r\n        <Progress\r\n          stop={true}\r\n          sentCount={this.state.sentCount}\r\n          customerCount={this.state.customerCount}\r\n          onSentCountChange={() => {}}\r\n        />\r\n        <div className=\"mesblkml-result\">\r\n          <div>Completed</div>\r\n          <div>{message}</div>\r\n        </div>\r\n        <div className=\"mesblkml-retart\">\r\n          <Link\r\n            to=\"/\"\r\n            onClick={() => {\r\n              onRestart();\r\n            }}\r\n          >\r\n            Home\r\n          </Link>\r\n        </div>\r\n        <div />\r\n      </div>\r\n    );\r\n    return <div className=\"mesblkml-sender\">{element}</div>;\r\n  }\r\n}\r\nexport default Sender;\r\n","import React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nfunction Navigation(props) {\r\n  const { prevPath, prevLabel, onPrev, nextPath, nextLabel, onNext } = props;\r\n  const noop = () => {};\r\n  return (\r\n    <div className=\"mesblkml-navigation\">\r\n      {prevPath ? (\r\n        <Link to={prevPath} onClick={onPrev ? onPrev : noop}>\r\n          {prevLabel ? prevLabel : \"Previous\"}\r\n        </Link>\r\n      ) : null}\r\n      {nextPath ? (\r\n        <Link to={nextPath} onClick={onNext ? onNext : noop}>\r\n          {nextLabel ? nextLabel : \"Next\"}\r\n        </Link>\r\n      ) : null}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Navigation;\r\n","import React from \"react\";\r\nimport { MemoryRouter as Router } from \"react-router\";\r\nimport { Route, Switch } from \"react-router-dom\";\r\n\r\nimport HomePage from \"./HomePage\";\r\nimport Composer from \"./Composer\";\r\nimport Previewer from \"./Previewer\";\r\nimport Sender from \"./Sender\";\r\nimport Navigation from \"./Navigation\";\r\nimport JsonRequest from \"./JsonRequest\";\r\nimport Highlight from \"./Highlight\";\r\n\r\nimport { resources, plural } from \"../util\";\r\n\r\nclass App extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      initCount: 0,\r\n      isNewEmail: true,\r\n      email: {\r\n        postcodes: null,\r\n        subject: \"\",\r\n        message: \"\",\r\n        dirty: false,\r\n        touched: {}\r\n      },\r\n      progress: {\r\n        sentCount: 0,\r\n        customerCount: 0,\r\n        clientId: \"\"\r\n      },\r\n      quota: {\r\n        limit: 0,\r\n        used: 0,\r\n        nextRenewal: \"\"\r\n      },\r\n      nonce: \"\",\r\n      emailTemplate: \"\",\r\n      emailPreviewCount: 0\r\n    };\r\n  }\r\n\r\n  buildEmailObj(obj) {\r\n    let postcodes = (obj && obj.postcodes) || null;\r\n    if (postcodes)\r\n      postcodes = postcodes.split(\",\").map(x => ({ label: x, value: x }));\r\n    //console.log(\"fetched postcd\", postcodes);\r\n    return {\r\n      postcodes,\r\n      subject: (obj && obj.subject) || \"\",\r\n      message: (obj && obj.message) || \"\",\r\n      dirty: !!obj,\r\n      touched: {}\r\n    };\r\n  }\r\n\r\n  buildProgressObj(obj) {\r\n    return {\r\n      sentCount: (obj && obj.sentCount) || 0,\r\n      customerCount: (obj && obj.customerCount) || 0,\r\n      clientId: (obj && obj.clientId) || Math.floor(Date.now() / 1000)\r\n    };\r\n  }\r\n\r\n  handleSavedEmailDelete = () => {\r\n    this.setState({\r\n      isNewEmail: true,\r\n      email: this.buildEmailObj(null),\r\n      progress: this.buildProgressObj(null)\r\n    });\r\n  };\r\n\r\n  handleEmailDraftChange = e => {\r\n    const { name, value } = e.target;\r\n    this.setState({\r\n      email: {\r\n        ...this.state.email,\r\n        [name]: value,\r\n        dirty: true,\r\n        touched: { ...this.state.email.touched, [name]: 1 }\r\n      },\r\n      progress: {\r\n        ...this.state.progress,\r\n        customerCount: 0\r\n      }\r\n    });\r\n  };\r\n\r\n  handlePostcodeChange = selectedOptionsData => {\r\n    this.setState({\r\n      email: {\r\n        ...this.state.email,\r\n        postcodes: selectedOptionsData,\r\n        dirty: true,\r\n        touched: { ...this.state.email.touched, postcodes: 1 }\r\n      },\r\n      progress: {\r\n        ...this.state.progress,\r\n        customerCount: 0\r\n      }\r\n    });\r\n  };\r\n\r\n  handleSentCountChange = newCount => {\r\n    this.setState({\r\n      progress: { ...this.state.progress, sentCount: newCount }\r\n    });\r\n  };\r\n\r\n  handlerPreviewGenerate = data => {\r\n    const obj = {\r\n      email: { ...this.state.email, dirty: false }\r\n    };\r\n    if (this.state.isNewEmail) {\r\n      obj[\"progress\"] = {\r\n        ...this.state.progress,\r\n        customerCount: data.customerCount\r\n      };\r\n    }\r\n    this.setState(obj);\r\n  };\r\n\r\n  handleRestart = () =>\r\n    this.setState(prevState => ({ initCount: prevState.initCount + 1 }));\r\n\r\n  handleEmailPreviewUpdate = () =>\r\n    this.setState(prevState => ({\r\n      emailPreviewCount: prevState.emailPreviewCount + 1\r\n    }));\r\n\r\n  renderInitRequest() {\r\n    return (\r\n      <JsonRequest\r\n        data={{ action: \"mesbulkemailerinit\" }}\r\n        resource={resources.error.custom && resources.app.hasSavedEmail}\r\n        progressMessage={\r\n          !this.state.initCount ? \"Initializing App\" : \"Fetching status\"\r\n        }\r\n        onSuccess={obj => {\r\n          //console.log(\"app::\", obj);\r\n          this.setState(prevState => ({\r\n            initCount: prevState.initCount + 1,\r\n            isNewEmail: !obj.savedEmail,\r\n            email: this.buildEmailObj(obj.savedEmail),\r\n            progress: this.buildProgressObj(obj.savedEmail),\r\n            quota: obj.quota,\r\n            nonce: obj.nonce,\r\n            emailTemplate: obj.emailTemplate\r\n          }));\r\n        }}\r\n        onComplete={() => \"app oncomplete called\"}\r\n      />\r\n    );\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    //console.log(\"app: unmounting\");\r\n  }\r\n\r\n  render() {\r\n    //console.log(\"app state\", this.state);\r\n    const {\r\n      initCount,\r\n      isNewEmail,\r\n      email,\r\n      progress,\r\n      quota,\r\n      nonce,\r\n      emailTemplate,\r\n      emailPreviewCount\r\n    } = this.state;\r\n    const emailValidation = Object.keys(email)\r\n      .filter(p => \"dirty\" !== p && \"touched\" !== p)\r\n      .reduce(\r\n        (o, p) => ({\r\n          ...o,\r\n          [p]:\r\n            email[p] &&\r\n            (Array.isArray(email[p])\r\n              ? !!email[p].length\r\n              : !!String(email[p]).trim())\r\n        }),\r\n        {}\r\n      );\r\n    const isInvalidEmail = Object.keys(emailValidation).filter(\r\n      p => !emailValidation[p]\r\n    ).length;\r\n    //console.log(emailValidation, isInvalidEmail);\r\n    return !(initCount % 2) ? (\r\n      <div className=\"mes-hvcenter\">{this.renderInitRequest()}</div>\r\n    ) : (\r\n      <Router initialEntries={[\"/\", \"/compose\", \"/preview\"]}>\r\n        <Switch>\r\n          <Route\r\n            path=\"/\"\r\n            exact\r\n            render={() => (\r\n              <HomePage\r\n                quota={quota}\r\n                savedEmail={isNewEmail ? null : { ...email, ...progress }}\r\n                nonce={nonce}\r\n                clientId={progress.clientId}\r\n                onSavedEmailDelete={this.handleSavedEmailDelete}\r\n              />\r\n            )}\r\n          />\r\n          <Route\r\n            path=\"/compose\"\r\n            exact\r\n            render={() => (\r\n              <div id=\"mesblkml-compose\">\r\n                <h2>Compose Email</h2>\r\n                <Composer\r\n                  {...this.state.email}\r\n                  allPostcodes={this.props.allPostcodes}\r\n                  onChange={this.handleEmailDraftChange}\r\n                  validation={emailValidation}\r\n                  onPostcodeChange={this.handlePostcodeChange}\r\n                  emailTemplate={emailTemplate}\r\n                  onEmailPreviewUpdate={this.handleEmailPreviewUpdate}\r\n                  emailPreviewCount={emailPreviewCount}\r\n                />\r\n                <Navigation\r\n                  prevPath=\"/\"\r\n                  prevLabel=\"Home\"\r\n                  nextPath=\"/preview\"\r\n                  nextLabel=\"Review\"\r\n                  onNext={e => {\r\n                    const dirty = this.state.email.dirty;\r\n                    this.setState({\r\n                      email: {\r\n                        ...this.state.email,\r\n                        dirty: true,\r\n                        touched: { postcodes: 1, subject: 1, message: 1 }\r\n                      }\r\n                    });\r\n                    if (isInvalidEmail) e.preventDefault();\r\n                    else {\r\n                      this.setState({\r\n                        email: { ...this.state.email, dirty, touched: {} }\r\n                      });\r\n                    }\r\n                  }}\r\n                />\r\n              </div>\r\n            )}\r\n          />\r\n          <Route\r\n            path=\"/preview\"\r\n            exact\r\n            render={() => (\r\n              <div id=\"mesblkml-preview\">\r\n                <h2>Preview Email</h2>\r\n                <Previewer\r\n                  {...this.state}\r\n                  onPreviewGenerate={this.handlerPreviewGenerate}\r\n                />\r\n                <Navigation\r\n                  prevPath={isNewEmail ? \"/compose\" : \"/\"}\r\n                  prevLabel={isNewEmail ? \"Compose\" : \"Home\"}\r\n                  nextPath={progress.customerCount ? \"/process\" : false}\r\n                  nextLabel=\"Confirm & Send\"\r\n                  onNext={e => {\r\n                    if (!window.confirm(`Are you sure to send this email?`))\r\n                      e.preventDefault();\r\n                  }}\r\n                />\r\n              </div>\r\n            )}\r\n          />\r\n          <Route\r\n            path=\"/process\"\r\n            exact\r\n            render={() => (\r\n              <div id=\"mesblkml-process\">\r\n                <h2>Sending Email</h2>\r\n                <p>\r\n                  <small>having</small> subject{\" \"}\r\n                  <Highlight v={this.state.email.subject} />\r\n                </p>\r\n                <p>\r\n                  <small>to</small>{\" \"}\r\n                  {plural(\r\n                    this.state.email.postcodes.length,\r\n                    \"postcodes\",\r\n                    \"postcode\"\r\n                  )}{\" \"}\r\n                  <Highlight\r\n                    v={this.state.email.postcodes\r\n                      .filter(o => \"*\" !== o.value)\r\n                      .map(o => o.value)}\r\n                  />\r\n                </p>\r\n                <Sender\r\n                  {...this.state}\r\n                  onSentCountChange={this.handleSentCountChange}\r\n                  onRestart={this.handleRestart}\r\n                />\r\n              </div>\r\n            )}\r\n          />\r\n        </Switch>\r\n      </Router>\r\n    );\r\n  }\r\n}\r\nexport default App;\r\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport \"./styles.css\";\nimport spinnerGif from \"./spinner.gif\";\n\nimport withRequest, {\n  RequestProgress,\n  RequestError,\n  requestConfig\n} from \"./components/withRequest\";\nimport App from \"./components/App\";\nimport Quota from \"./components/Quota\";\nimport Composer from \"./components/Composer\";\nimport Navigation from \"./components/Navigation\";\nimport Progress from \"./components/Progress\";\nimport Sender from \"./components/Sender\";\nimport Field from \"./components/Field\";\nimport MySelect, {\n  Option,\n  MultiValue,\n  ValueContainer,\n  animatedComponents\n} from \"./components/MySelect.js\";\nimport Highlight from \"./components/Highlight\";\nconst colourOptions = [\n  { value: \"ocean1\", label: \"Ocean\", color: \"#00B8D9\" },\n  { value: \"blue\", label: \"Blue\", color: \"#0052CC\" },\n  { value: \"purple\", label: \"Purple\", color: \"#5243AA\" },\n  { value: \"red\", label: \"Red\", color: \"#FF5630\" },\n  { value: \"orange\", label: \"Orange\", color: \"#FF8B00\" },\n  { value: \"yellow\", label: \"Yellow\", color: \"#FFC400\" },\n  { value: \"green\", label: \"Green\", color: \"#36B37E\" },\n  { value: \"forest\", label: \"Forest\", color: \"#00875A\" },\n  { value: \"slate\", label: \"Slate\", color: \"#253858\" },\n  { value: \"silver\", label: \"Silver\", color: \"#666666\" }\n];\nconst delay = ms => cb => setTimeout(cb, ms);\nconst allPostcodes = [\n  \"Test\",\n  \"BT1\",\n  \"BT2\",\n  \"BT3\",\n  \"BT4\",\n  \"BT5\",\n  \"BT6\",\n  \"BT7\",\n  \"BT8\",\n  \"BT9\",\n  \"BT10\",\n  \"BT11\",\n  \"BT12\",\n  \"BT13\",\n  \"BT14\",\n  \"BT15\",\n  \"BT16\",\n  \"BT17\",\n  \"BT18\",\n  \"BT19\",\n  \"BT20\",\n  \"BT21\",\n  \"BT22\",\n  \"BT23\",\n  \"BT24\",\n  \"BT25\",\n  \"BT26\",\n  \"BT27\",\n  \"BT28\",\n  \"BT32\",\n  \"BT36\",\n  \"BT37\",\n  \"BT38\",\n  \"BT61\",\n  \"BT62\",\n  \"BT63\",\n  \"BT64\",\n  \"BT65\",\n  \"BT66\",\n  \"BT67\"\n];\n\nclass Test extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      email: {\n        postcodes: null,\n        subject: \"abc\",\n        message: \"xad\",\n        dirty: false\n      },\n      stop: false,\n      sentCount: 34,\n      stopCount: 100,\n      selected: null\n    };\n  }\n  handleEmailDraftChange = e => {\n    const { name, value } = e.target;\n    console.log(name, value);\n    this.setState({\n      email: { ...this.state.email, [name]: value }\n    });\n  };\n\n  handlePostcodeChange = selected => {\n    console.log(selected);\n    this.setState({\n      email: { ...this.state.email, postcodes: selected }\n    });\n    return;\n    this.setState({\n      email: { ...this.state.email, postcodes: selected.map(x => x.value) }\n    });\n  };\n\n  render() {\n    const optionsData = allPostcodes.map(postcode => ({\n      value: postcode,\n      label: postcode\n    }));\n    const selectedOptionsData =\n      this.state.email.postcodes &&\n      this.state.email.postcodes.map(postcode => ({\n        value: postcode,\n        label: postcode\n      }));\n    return (\n      <div>\n        <MySelect\n          options={optionsData}\n          isMulti\n          closeMenuOnSelect={false}\n          hideSelectedOptions={false}\n          components={{\n            Option,\n            MultiValue,\n            ValueContainer,\n            animatedComponents\n          }}\n          onChange={this.handlePostcodeChange}\n          allowSelectAll={true}\n          value={this.state.email.postcodes}\n        />\n      </div>\n    );\n    return (\n      <div>\n        <Composer\n          {...this.state.email}\n          onChange={this.handleEmailDraftChange}\n          allPostcodes={allPostcodes}\n          onPostcodeChange={this.handlePostcodeChange}\n        />\n        <button\n          onClick={() =>\n            this.setState(p => {\n              return {\n                email: { ...p.email, dirty: !p.email.dirty }\n              };\n            })\n          }\n        >\n          {!this.state.email.dirty ? \"dirty\" : \"undirty\"}\n        </button>\n      </div>\n    );\n  }\n}\nfunction App2() {\n  return <App allPostcodes={allPostcodes} />;\n}\nclass ErrorBoundry extends React.Component {\n  componentDidCatch(err, errInfo) {\n    console.log(err, errInfo);\n  }\n  render() {\n    return <App />;\n  }\n}\nconst rootElement = document.getElementById(\"mesblkml\");\nReactDOM.render(<App2 />, rootElement);\n"],"sourceRoot":""}